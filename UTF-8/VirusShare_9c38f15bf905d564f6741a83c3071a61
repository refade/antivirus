function SapeRtbCommon(){this._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return this;};SapeRtbCommon.prototype.getStringHash=function(str){var strrev=str.split("").reverse().join(""),h1=this.crc32(str),h1s=h1.toString(),h2=this.crc32(strrev),h2s=h2.toString();return h1s+h2s;};SapeRtbCommon.prototype.utf8Encode=function(str){str=str.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<str.length;n++){var c=str.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c);}else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128);}else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128);}}return utftext;};SapeRtbCommon.prototype.utf8Decode=function(utftext){var string="";var i=0;var c=c1=c2=0;while(i<utftext.length){c=utftext.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);i++;}else if((c>191)&&(c<224)){c2=utftext.charCodeAt(i+1);string+=String.fromCharCode(((c&31)<<6)|(c2&63));i+=2;}else{c2=utftext.charCodeAt(i+1);c3=utftext.charCodeAt(i+2);string+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));i+=3;}}return string;};SapeRtbCommon.prototype.crc32=function(str){str=this.utf8Encode(str);var table="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 "+"0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 "+"1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 "+"136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 "+"3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B "+"35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 "+"26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F "+"2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D "+"76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 "+"7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 "+"6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 "+"65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 "+"4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB "+"4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 "+"5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F "+"5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD "+"EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 "+"E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 "+"F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 "+"FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 "+"D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B "+"D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 "+"CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F "+"C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D "+"9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 "+"95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 "+"86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 "+"88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 "+"A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB "+"AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 "+"BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF "+"B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";var crc=0,x=0,y=0;crc=crc ^(-1);for(var i=0,iTop=str.length;i<iTop;i++){y=(crc ^ str.charCodeAt(i))&0xFF;x="0x"+table.substr(y*9,8);crc=(crc>>>8)^ x;}return(crc ^(-1))>>>0;};SapeRtbCommon.prototype.arrayUnique=function(arr){var o={},a=[],i,e;for(i=0;e=arr[i];i++){o[e]=1;}for(e in o){a.push(e);}return a;};SapeRtbCommon.prototype.createIFrame=function(id,w,h,src){var f=document.createElement('iframe');f.setAttribute('scrolling','no');f.setAttribute('frameborder','0');f.setAttribute('marginwidth','0');f.setAttribute('marginheight','0');f.setAttribute('width',w);f.setAttribute('height',h);f.id=id;f.src=(typeof src!=='undefined')?src:'about:blank';return f;};SapeRtbCommon.prototype.createIFrameWithContent=function(p,html,width,height){var id='FRAME_'+p.id;p.appendChild(this.createIFrame(id,width,height));window.SapeRtbUCodeIFrameContent=function(n,id,html){var d;try{if(document.all&&!window.opera){d=window.frames[id].document;}else if(document.getElementById){d=document.getElementById(id).contentDocument;}}catch(e){;}if(n>0){if(typeof d==='undefined'){setTimeout(SapeRtbUCodeIFrameContent,100,--n,id,html);}else{d.open();d.write(html);d.close();}}};SapeRtbUCodeIFrameContent(10,id,html);};SapeRtbCommon.prototype.isInIframe=function(){try{return window.self!==window.top;}catch(e){return true;}};SapeRtbCommon.prototype.nodeScriptClone=function(node){var script=document.createElement("script");script.text=node.innerHTML;for(var i=node.attributes.length-1;i>=0;i--){script.setAttribute(node.attributes[i].name,node.attributes[i].value);}return script;};SapeRtbCommon.prototype.evalNode=function(node){if(node.tagName==='SCRIPT'){node.parentNode.replaceChild(this.nodeScriptClone(node),node);}else{var i=0,children=node.childNodes;while(i<children.length){this.evalNode(children[i++]);}}return node;};SapeRtbCommon.prototype.addEventListenerCrossBrowser=function(target,type,handler){if(target.addEventListener){target.addEventListener(type,handler,false);}else if(target.attachEvent){target.attachEvent("on"+type,function(event){handler.call(target,event)});}else{throw 'Cannot add event listener: no Event API support in client'}};SapeRtbCommon.prototype.hasClass=function(e,c){return(" "+e.className+" ").indexOf(" "+c+" ")>-1;};SapeRtbCommon.prototype.previousTag=function(node){var node=node.previousSibling;return(node&&node.nodeType!=1)?this.previousTag(node):node;};SapeRtbCommon.prototype.nextTag=function(node){var node=node.nextSibling;return(node&&node.nodeType!=1)?this.nextTag(node):node;};SapeRtbCommon.prototype.firstChildTag=function(node){var node=node.firstChild;return(node&&node.nodeType!=1)?this.nextTag(node):node;};SapeRtbCommon.prototype.lastChildTag=function(node){var node=node.lastChild;return(node&&node.nodeType!=1)?this.previousTag(node):node;};SapeRtbCommon.prototype.encode64=function(input){var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;input=this.utf8Encode(input);while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64;}else if(isNaN(chr3)){enc4=64;}output=output+this._keyStr.charAt(enc1)+this._keyStr.charAt(enc2)+this._keyStr.charAt(enc3)+this._keyStr.charAt(enc4);}return output;};SapeRtbCommon.prototype.decode64=function(input){var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length){enc1=this._keyStr.indexOf(input.charAt(i++));enc2=this._keyStr.indexOf(input.charAt(i++));enc3=this._keyStr.indexOf(input.charAt(i++));enc4=this._keyStr.indexOf(input.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;output=output+String.fromCharCode(chr1);if(enc3!=64){output=output+String.fromCharCode(chr2);}if(enc4!=64){output=output+String.fromCharCode(chr3);}}output=this.utf8Decode(output);return output;};SapeRtbCommon.prototype.sapeRTBisMobile=function(){return(/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase()));};SapeRtbCommon.prototype.generateSessionId=function(){return 'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*36|0;return r.toString(36);});};SapeRtbCommon.prototype.insertAfter=function(referenceNode,newNode){if(referenceNode.nextSibling){referenceNode.parentNode.insertBefore(newNode,referenceNode.nextSibling);}else{referenceNode.parentNode.appendChild(newNode);}};SapeRtbCommon.prototype.getTimeZoneOffsetIso8601=function(){var o=(new Date()).getTimezoneOffset();return(o>0?"-":"+")+this.padInt(Math.floor(Math.abs(o)/60))+':'+this.padInt(Math.abs(o)%60);};SapeRtbCommon.prototype.encodeUriParam=function(value){if(null==value){return '';}value=''+value;return(encodeURIComponent instanceof Function)?encodeURIComponent(value):escape(value);};SapeRtbCommon.prototype.padInt=function(v){return(v<10?'0'+v:''+v);};SapeRtbCommon.prototype.onIFrameDocumentReady=function(id,onReady,onTimeout){var f=function(id,onReady,onTimeout,n){var d;try{if(document.all&&!window.opera){d=window.frames[id].document;}else if(document.getElementById){d=document.getElementById(id).contentDocument;}}catch(e){}if(n>0){if(typeof d==='undefined'||d===null||(d.readyState!='interactive'&&d.readyState!='complete')){n--;setTimeout(f,100,id,onReady,onTimeout,n);}else{onReady(d);}}else{onTimeout();}};f(id,onReady,onTimeout,50);};SapeRtbCommon.prototype.strEndsWith=function(str,suffix){return str&&str.indexOf(suffix,str.length-suffix.length)!==-1;};SapeRtbCommon.prototype.setConsole=function(){var methods=["assert","cd","clear","count","countReset","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","select","table","time","timeEnd","timeStamp","timeline","timelineEnd","trace","warn"];var length=methods.length;var console=(window.console=window.console||{});var method;var noop=function(){};while(length--){method=methods[length];if(!console[method])console[method]=noop;}};SapeRtbCommon.prototype.clone=function(obj){var copy;if(null==obj||"object"!=typeof obj)return obj;if(obj instanceof Date){copy=new Date();copy.setTime(obj.getTime());return copy;}if(obj instanceof Array){copy=[];for(var i=0,len=obj.length;i<len;i++){copy[i]=this.clone(obj[i]);}return copy;}if(obj instanceof Object){copy={};for(var attr in obj){if(obj.hasOwnProperty(attr))copy[attr]=this.clone(obj[attr]);}return copy;}throw new Error("Unable to copy obj! Its type isn't supported.");};SapeRtbCommon.prototype.json_parse=function(sJSON){return eval('('+sJSON+')');};SapeRtbCommon.prototype.json_stringify=(function(){var toString=Object.prototype.toString;var hasOwnProperty=Object.prototype.hasOwnProperty;var isArray=Array.isArray||function(a){return toString.call(a)==='[object Array]';};var escMap={'"':'\\"','\\':'\\\\','\b':'\\b','\f':'\\f','\n':'\\n','\r':'\\r','\t':'\\t'};var escFunc=function(m){return escMap[m]||'\\u'+(m.charCodeAt(0)+0x10000).toString(16).substr(1);};var escRE=/[\\"\u0000-\u001F\u2028\u2029]/g;return function stringify(value){if(value==null){return 'null';}else if(typeof value==='number'){return isFinite(value)?value.toString():'null';}else if(typeof value==='boolean'){return value.toString();}else if(typeof value==='object'){if(typeof value.toJSON==='function'){return stringify(value.toJSON());}else if(isArray(value)){var res='[';for(var i=0;i<value.length;i++)res+=(i?', ':'')+stringify(value[i]);return res+']';}else if(toString.call(value)==='[object Object]'){var tmp=[];for(var k in value){if(hasOwnProperty.call(value,k))tmp.push(stringify(k)+': '+stringify(value[k]));}return '{'+tmp.join(', ')+'}';}}return '"'+value.toString().replace(escRE,escFunc)+'"';};})();SapeRtbCommon.prototype.get_keywords=function(){var keywords='';var metas=document.getElementsByTagName('meta');if(metas){for(var x=0,y=metas.length;x<y;x++){if(metas[x].name.toLowerCase()=="keywords"){keywords+=metas[x].content;}}}return keywords!=''?keywords:false;};SapeRtbCommon.prototype.get_href=function(){var href='';try{href=top.location.href;}catch(err){}if(href==''){var wnd=window;do{try{if(typeof wnd.document.referrer!=='undefined'){href=wnd.document.referrer.match(/([^\?]+)/)[1];}}catch(err){}if(wnd){wnd=wnd.parent;}}while(wnd&&wnd!=wnd.parent);}if(href==''){href=window.location.href;}return href;};function SapeRtbClientCode(srtbid,srtbuid,isNG,rfrsh,srtbdmn,ads,constData){this.srtbid=srtbid;this.srtbuid=srtbuid;this.isNG=isNG;this.rfrsh=rfrsh;this.srtbdmn=srtbdmn;this.ads=ads;for(var property in constData){if(constData.hasOwnProperty(property)){this[property]=constData[property];}}this.common=new SapeRtbCommon();this.listener_added=false;this.wvd2_added=false;this.wvd_added=false;this.wvd2_shown=false;this.wvd_shown=false;this.vdpk_added=false;this.vdpk_mob_added=false;this.mmb_added=false;this.keywords=this.common.get_keywords();this.href=this.common.get_href();this.sid=this.common.generateSessionId();this.previousErrorHandler=null;return this;};SapeRtbClientCode.prototype.sapeRTBClosePopup=function(event){this.parentNode.style.display='none';var id=this.parentNode.id,pid=(id==''?0:parseInt(id.replace('SRTB_',''))),ad;if(pid>0){for(var b=0;b<window.sapeRtbHandler_78547.ads.length;b++){ad=window.sapeRtbHandler_78547.ads[b];if(window.sapeRtbHandler_78547.ads[b].id==pid){window.sapeRtbHandler_78547.ads[b].popup_closed=true;}}}this.parentNode.parentNode.removeChild(this.parentNode);if(event.preventDefault){event.preventDefault();}return false;};SapeRtbClientCode.prototype.sapeRTBCloseFloat=function(event){this.parentNode.parentNode.style.display='none';this.parentNode.parentNode.parentNode.removeChild(this.parentNode.parentNode);if(event.preventDefault){event.preventDefault();}return false;};SapeRtbClientCode.prototype.sapeRTBGetBranchNumber=function(data,branch){for(var key in data.branches){if(data.branches.hasOwnProperty(key)){if(data.branches[key].join(',')==branch){return key;}}}};SapeRtbClientCode.prototype.sapeRTBStartBranch=function(data){return this.sapeRTBDrawBanner(data,data.branches[data.branch_number][data.partner_number]);};SapeRtbClientCode.prototype.branchCodeStd=function(ad,branches){ad.branch_number=this.sapeRTBGetBranchNumber(ad,branches);if(typeof ad.partner_number=='undefined'){ad.partner_number=0;}else if(!ad.done){ad.partner_number++;}if(ad.branches[ad.branch_number][ad.partner_number]==this.sas){if(typeof ad.branches_data[ad.branch_number]!='undefined'&&typeof ad.branches_data[ad.branch_number].sc_id!='undefined'){this.sasIds.push(ad.branches_data[ad.branch_number].sc_id);this.sapeRTBTrackingCode(ad,1);ad.done=1;ad.sas_waiting=true;var that=this;setTimeout(function(){that.sapeRTBSkipSas();},5000,ad.id);return true;}}else{var sectionData=ad;if(this.sapeRTBStartBranch(ad)){ad.done=1;ad.current_partner=sectionData.branches[ad.branch_number][sectionData.partner_number];return true;}else{if(typeof sectionData.branches[sectionData.branch_number][sectionData.partner_number]!=='undefined'){return false;}else{return true;}}}};SapeRtbClientCode.prototype.sapeRTBTrackingCode=function(sectionData,status){var pixel=document.createElement('img'),partner=sectionData.branches[sectionData.branch_number][sectionData.partner_number-(status==this.pix_noad?1:0)],src,section;if(partner>0&&sectionData.sections[sectionData.branch_number]){section=sectionData.sections[sectionData.branch_number][sectionData.partner_number-(status==this.pix_noad?1:0)];}else{section=0;}src='//www.acint.net/pxl/'+status+'?dp='+partner+'&id='+this.srtbid+'.'+sectionData.id+'.'+section+'&sid='+this.sid;if(partner==this.tml){src+='&slot='+sectionData.tml_slot;}else if(partner==this.tml_cpm){src+='&slot='+sectionData.tml_cpm_slot;}src+='&r=';var possible="abcdefghijklmnopqrstuvwxyz0123456789";for(var i=0;i<12;i++){src+=possible.charAt(Math.floor(Math.random()*possible.length));}pixel.alt="";pixel.src=src;pixel.style.width='1px';pixel.style.height='1px';pixel.style.position='fixed';pixel.style.left='-100px';pixel.style.top='-100px';pixel.style.opacity=0;if(document.body!=null){document.body.appendChild(pixel);}else if(document.getElementsByTagName('body').length){document.getElementsByTagName('body')[0].appendChild(pixel);}};SapeRtbClientCode.prototype.sapeRTBTrackJsErrors=function(msg,url,line,col,error){var pixel=document.createElement('img'),src='//cdn-rtb.sape.ru/rtb-b/track/error/'+'?msg='+this.common.encodeUriParam(msg)+'&url='+this.common.encodeUriParam(url)+'&line='+this.common.encodeUriParam(line)+'&col='+this.common.encodeUriParam(col);if(error){src=src+'&error='+this.common.encodeUriParam(typeof error.stack==='undefined'?error:error.stack);}pixel.alt="";pixel.src=src;pixel.style.width='1px';pixel.style.height='1px';pixel.style.position='fixed';pixel.style.left='-100px';pixel.style.top='-100px';pixel.style.opacity=0;if(document.body!=null){document.body.appendChild(pixel);}else if(document.getElementsByTagName('body').length){document.getElementsByTagName('body')[0].appendChild(pixel);}if(this.previousErrorHandler){return this.previousErrorHandler(msg,url,line,col,error);}else{return false;}};SapeRtbClientCode.prototype.validateCurrentHost=function(){var urls=[],result=false;var currentHost='';try{currentHost=top.location.host;}catch(err){}if(currentHost==''){var wnd=window;do{try{if(typeof wnd.document.referrer!=='undefined'){currentHost=wnd.document.referrer.match(/:\/\/(.[^/]+)/)[1];}}catch(err){}if(wnd){wnd=wnd.parent;}}while(wnd&&wnd!=wnd.parent);}if(currentHost==''){currentHost=window.location.host;}if(typeof currentHost!=='undefined'&&currentHost){urls.push(currentHost);for(var b=0;b<urls.length;b++){var url=urls[b];for(var s=0;s<this.srtbdmn.length;s++){var srtbdmn=this.srtbdmn[s];if(url==srtbdmn||url=='www.'+srtbdmn||this.common.strEndsWith(url,'.'+srtbdmn)){result=true;break;}}}if(result==false){this.sapeRTBTrackJsErrors('Cannot run code for site '+this.srtbid+' on domain '+currentHost,'');}}return result;};SapeRtbClientCode.prototype.validateElementVis=function(elementId){var el=document.getElementById('SRTB_'+elementId);try{if(el&&(el.offsetWidth==0||el.offsetHeight==0)){this.sapeRTBTrackJsErrors('Place empty offset for ID='+el.id,'');}}catch(e){}};SapeRtbClientCode.prototype.sapeRTBDrawBanner=function(data,partner){var dv,result=1;dv=document.getElementById('SRTB_'+data.id);if((dv&&dv.children&&dv.children.length===0)||data.mobile){if(data.popup&&!data.mobile){result=this.sapeRTBDrawBannerPopup(dv,data,partner);}else if(data.type==this.type_video){result=this.sapeRTBDrawBannerVideo(dv,data,partner);}else if(data.type==this.type_mobile_float){result=this.sapeRTBDrawMobileFloat(document.body,data,partner);}else if(data.type==this.type_mobile_video){result=this.sapeRTBDrawMobileVideo(document.body,data,partner);}else if(data.type==this.type_mobile_fullscreen){result=this.sapeRTBDrawMobileFulscreen(document.body,data,partner);}else if(data.type==this.type_inpage){result=this.sapeRTBDrawBannerInpage(dv,data,partner);}else if(partner==this.btw){result=this.sapeRTBInsertBtwElement(dv,data,this.btw);}else if(partner==this.btw2){result=this.sapeRTBInsertBtw2Element(dv,data);}else if(partner==this.btw_cpm){result=this.sapeRTBInsertBtwCpmElement(dv,data);}else if(partner==this.btw2_cpm){result=this.sapeRTBInsertBtw2CpmElement(dv,data);}else if(partner==this.btw_chp){result=this.sapeRTBInsertBtwChpElement(dv,data);}else if(partner==this.tml){result=this.sapeRTBInsertTmlElement(dv,data);}else if(partner==this.tml_cpm){result=this.sapeRTBInsertTmlCpmElement(dv,data);}else if(partner==46){result=this.sapeRTBInsertMmbElement(dv,data);}else if(partner==28){result=this.sapeRTBInsertCrtElement(dv,data);}else if(partner==16){result=this.sapeRTBInsertSasElement(dv,data);}else if(partner==70){result=this.sapeRTBInsertYdxElement(dv,data);}else if(partner==61){result=this.sapeRTBInsertDatElement(dv,data);}else if(partner==161){result=this.sapeRTBInsertDat2Element(dv,data);}else if(partner==64){result=this.sapeRTBInsertMgidElement(dv,data);}else if(partner==153){result=this.sapeRTBInsertWvd2Element(dv,data);}else if(partner==78){result=this.sapeRTBInsertGrcElement(dv,data);}else if(partner==82){result=this.sapeRTBInsertAdvrElement(dv,data);}else if(partner==83){result=this.sapeRTBInsertAdtsElement(dv,data);}else if(partner==this.adts_cpm){result=this.sapeRTBInsertAdtsCpmElement(dv,data);}else if(partner==90){result=this.sapeRTBInsertSmi2Element(dv,data);}else{result=this.sapeRTBInsertStubElement(dv,data);}}else if(!dv&&data.popup&&!data.popup_closed){dv=document.createElement('div');dv.id='SRTB_'+data.id;result=this.sapeRTBDrawBannerPopup(dv,data,partner);if(result===0){document.body.appendChild(dv);}}else if(!dv&&data.float){dv=document.createElement('div');dv.id='SRTB_'+data.id;result=this.sapeRTBDrawBannerFloat(dv,data,partner);if(result===0){document.body.appendChild(dv);}}if(result===0){if(partner!=this.sas||typeof data.htmlData==='undefined'){this.sapeRTBTrackingCode(data,this.pix_imp);}if(partner!=this.sas||typeof data.htmlData!=='undefined'){var that=this;setTimeout(function(){that.validateElementVis(data.id);},3000);if(this.rfrsh&&partner!=0&&data.type==this.type_banner){for(var b=0;b<this.ads.length;b++){if(this.ads[b].id==data.id){if(typeof this.ads[b].shown==='undefined'){this.ads[b].shown=[];}this.ads[b].shown.push(partner);}}setTimeout(function(partner_id,pid){var msg={provider:'sRTBMsg',act:'rfrsh',partner_id:partner_id,sectionId:pid},win=window;win.postMessage(sapeRtbHandler_78547.common.json_stringify(msg),'*');while(win!=win.parent){win=win.parent;win.postMessage(sapeRtbHandler_78547.common.json_stringify(msg),'*');}},20000,partner,data.id);}}}else if(result===1){if(partner!=0){this.sapeRTBTrackingCode(data,this.pix_err);}}return result===0;};SapeRtbClientCode.prototype.sapeRTBDrawBannerPopup=function(dv,data,partner){var result=2;if(this.common.sapeRTBisMobile()&&!data.mobile){return result;}var w=window;if(Object.prototype.hasOwnProperty.call(w,'sapeRTBNoPopup')&&w.sapeRTBNoPopup==true){return result;}if(typeof w.sapeRtbBannerPopupCount==="undefined"){w.sapeRtbBannerPopupCount={length:0};}if(!w.sapeRtbBannerPopupCount.hasOwnProperty(dv.id)&&w.sapeRtbBannerPopupCount.length>=2){return 0;}var acl=document.createElement('a'),partner_div=document.createElement('div');partner_div.id='SRTB_PARTNER_'+data.id;partner_div.style.position='relative';acl.innerHTML='<img style="border:0;outline:none;width:32px;height:32px;" src="//cdn-rtb.sape.ru/rtb-b/i/close.png">';acl.style.position='absolute';acl.style.border=0;acl.style.outline='none';acl.style.zIndex=9999;acl.style.display="block";acl.href='#';acl.className='SRTB_CLOSE';dv.style.position='fixed';dv.style.backgroundColor='#fff';dv.style.width=data.w+'px';dv.style.height=data.h+'px';partner_div.style.width=data.w+'px';partner_div.style.height=data.h+'px';switch(data.popup){case this.bottom_right:dv.style.margin='1px';acl.style.left='-16px';acl.style.top='-16px';break;case this.bottom_left:dv.style.left='0px';dv.style.margin='1px';acl.style.right='-16px';acl.style.top='-16px';break;case this.top_right:dv.style.top='0px';dv.style.margin='1px';acl.style.left='-16px';acl.style.top='0px';break;case this.top_left:dv.style.left='0px';dv.style.top='0px';dv.style.margin='1px';acl.style.right='-16px';acl.style.top='0';break;case this.top_center:dv.style.left='50%';dv.style.top='0px';dv.style.margin="1px 1px 1px "+(-parseInt(data.w/2)+"px");acl.style.right='-16px';acl.style.top='-16px';break;case this.bottom_center:dv.style.left='50%';dv.style.margin="1px 1px 1px "+(-parseInt(data.w/2)+"px");acl.style.right='-16px';acl.style.top='-16px';break;default:acl.style.left='-16px';acl.style.bottom='-16px';}dv.style.right='0px';dv.style.bottom='0px';dv.style.zIndex="9999";if(partner==7){result=this.sapeRTBInsertBtwElement(partner_div,data,this.btw);}else if(partner==this.btw2){result=this.sapeRTBInsertBtw2Element(partner_div,data);}else if(partner==this.btw_cpm){result=this.sapeRTBInsertBtwCpmElement(partner_div,data);}else if(partner==this.btw2_cpm){result=this.sapeRTBInsertBtw2CpmElement(partner_div,data);}else if(partner==this.btw_chp){result=this.sapeRTBInsertBtwChpElement(partner_div,data);}else if(partner==this.tml){result=this.sapeRTBInsertTmlElement(partner_div,data);}else if(partner==this.tml_cpm){result=this.sapeRTBInsertTmlCpmElement(partner_div,data);}else if(partner==28){result=this.sapeRTBInsertCrtElement(partner_div,data);}else if(partner==16){result=this.sapeRTBInsertSasElement(partner_div,data);}else if(partner==70){result=this.sapeRTBInsertYdxElement(partner_div,data);}else if(partner==61){result=this.sapeRTBInsertDatElement(partner_div,data);}else if(partner==161){result=this.sapeRTBInsertDat2Element(partner_div,data);}else if(partner==64){result=this.sapeRTBInsertMgidElement(partner_div,data);}else if(partner==153){result=this.sapeRTBInsertWvd2Element(partner_div,data);}else if(partner==78){result=this.sapeRTBInsertGrcElement(partner_div,data);}else if(partner==82){result=this.sapeRTBInsertAdvrElement(partner_div,data);}else if(partner==83){result=this.sapeRTBInsertAdtsElement(partner_div,data);}else if(partner==this.adts_cpm){result=this.sapeRTBInsertAdtsCpmElement(partner_div,data);}else{result=this.sapeRTBInsertStubElement(partner_div,data);}if(result===0){document.body.appendChild(dv);dv.appendChild(acl);dv.appendChild(partner_div);this.common.addEventListenerCrossBrowser(this.common.firstChildTag(dv),'click',this.sapeRTBClosePopup);if(data.partner_number==0){w.sapeRtbBannerPopupCount.length++;w.sapeRtbBannerPopupCount[dv.id]=1;}}return result;};SapeRtbClientCode.prototype.sapeRTBDrawBannerFloat=function(dv,data,partner){var srtb_div=document.getElementById('SRTB_FLOAT_DIV'),result=2;if(srtb_div){if(typeof window['sapeRtbHandler_'+srtb_div.getAttribute('data-srtbid')]!=='undefined'&&window['sapeRtbHandler_'+srtb_div.getAttribute('data-srtbid')].float_open){return 2;}}var partner_div=document.createElement('div');partner_div.id='SRTB_FLOAT_DIV';partner_div.setAttribute('data-srtbid',this.srtbid);if(partner==7){result=this.sapeRTBInsertBtwFloatElement(partner_div,data);}else if(partner==107){result=this.sapeRTBInsertBtw2FloatElement(partner_div,data);}else if(partner==28){result=this.sapeRTBInsertCrtFloatElement(partner_div,data);}else if(partner==61){result=this.sapeRTBInsertDatFloatElement(partner_div,data);}else if(partner==161){result=this.sapeRTBInsertDat2FloatElement(partner_div,data);}else if(partner==64){result=this.sapeRTBInsertMgidFloatElement(partner_div,data);}else if(partner==80){result=this.sapeRTBInsertCcdFloatElement(partner_div,data);}else{result=this.sapeRTBInsertStubElement(partner_div,data);}if(result===0){dv.appendChild(partner_div);document.body.appendChild(dv);this.float_open=true;}return result;};SapeRtbClientCode.prototype.sapeRTBDrawBannerInpage=function(dv,data,partner){var result=2;if(partner==this.btw){result=this.sapeRTBInsertBtwElement(dv,data,this.btw);}else if(partner==this.btw2){result=this.sapeRTBInsertBtw2Element(dv,data);}else if(partner==this.btw_cpm){result=this.sapeRTBInsertBtwCpmElement(dv,data);}else if(partner==this.btw2_cpm){result=this.sapeRTBInsertBtw2CpmElement(dv,data);}else if(partner==this.wvd){result=this.sapeRTBInsertWvdInpageElement(dv,data);}else if(partner==this.wvd2){result=this.sapeRTBInsertWvd2InpageElement(dv,data);}else{result=this.sapeRTBInsertStubElement(dv,data);}return result;};SapeRtbClientCode.prototype.sapeRTBDrawBannerVideo=function(dv,data,partner){var result=2;if(partner==this.btw){result=this.sapeRTBInsertBtwElement(dv,data,this.btw);}else if(partner==this.btw2){result=this.sapeRTBInsertBtw2Element(dv,data);}else if(partner==this.btw_cpm){result=this.sapeRTBInsertBtwCpmElement(dv,data);}else if(partner==this.btw2_cpm){result=this.sapeRTBInsertBtw2CpmElement(dv,data);}else if(partner==this.wvd){result=this.sapeRTBInsertWvdVideoElement(dv,data);}else if(partner==this.wvd2){result=this.sapeRTBInsertWvd2VideoElement(dv,data);}else if(partner==this.vdpk){result=this.sapeRTBInsertVdpkVideoElement(dv,data);}else if(partner==this.sas){result=this.sapeRTBInsertSasElement(dv,data);}else if(partner==this.otm){result=this.sapeRTBInsertOtmVideoElement(dv,data);}else{result=this.sapeRTBInsertStubElement(dv,data);}return result;};SapeRtbClientCode.prototype.sapeRTBDrawMobileVideo=function(dv,data,partner){var result=2,btw=false;if([this.btw,this.btw2,this.btw_cpm,this.btw2_cpm].indexOf(partner)+1){dv=document.createElement('div');dv.id='SRTB_'+data.id;btw=true;}if(partner==this.vdpk){result=this.sapeRTBInsertVdpkMobileVideoElement(dv,data);}else if(partner==this.btw){result=this.sapeRTBInsertBtwElement(dv,data,this.btw);}else if(partner==this.btw2){result=this.sapeRTBInsertBtw2Element(dv,data);}else if(partner==this.btw_cpm){result=this.sapeRTBInsertBtwCpmElement(dv,data);}else if(partner==this.btw2_cpm){result=this.sapeRTBInsertBtw2CpmElement(dv,data);}else{result=this.sapeRTBInsertStubElement(dv,data);}if(result===0&&btw){document.body.appendChild(dv);}return result;};SapeRtbClientCode.prototype.sapeRTBDrawMobileFulscreen=function(dv,data,partner){var result=2,btw=false;if([this.btw,this.btw2,this.btw_cpm,this.btw2_cpm].indexOf(partner)+1){dv=document.createElement('div');dv.id='SRTB_'+data.id;btw=true;}if(partner==this.otm){result=this.sapeRTBInsertOtmMobileFullscreenElement(dv,data);}else if(partner==this.mmb){result=this.sapeRTBInsertMmbElement(dv,data);}else if(partner==this.sas){result=this.sapeRTBInsertSasElement(dv,data);}else if(partner==this.btw){result=this.sapeRTBInsertBtwElement(dv,data,this.btw);}else if(partner==this.btw2){result=this.sapeRTBInsertBtw2Element(dv,data);}else if(partner==this.btw_cpm){result=this.sapeRTBInsertBtwCpmElement(dv,data);}else if(partner==this.btw2_cpm){result=this.sapeRTBInsertBtw2CpmElement(dv,data);}else{result=this.sapeRTBInsertStubElement(dv,data);}if(result===0&&btw){document.body.appendChild(dv);}return result;};SapeRtbClientCode.prototype.sapeRTBDrawMobileFloat=function(dv,data,partner){var result=2,btw=false;if([this.btw,this.btw2,this.btw_cpm,this.btw2_cpm].indexOf(partner)+1){dv=document.createElement('div');dv.id='SRTB_'+data.id;btw=true;}if(partner==this.mmb){result=this.sapeRTBInsertMmbElement(dv,data);}else if(partner==this.btw){result=this.sapeRTBInsertBtwElement(dv,data,this.btw);}else if(partner==this.btw2){result=this.sapeRTBInsertBtw2Element(dv,data);}else if(partner==this.btw_cpm){result=this.sapeRTBInsertBtwCpmElement(dv,data);}else if(partner==this.btw2_cpm){result=this.sapeRTBInsertBtw2CpmElement(dv,data);}else if(partner==28){dv=document.createElement('div');dv.id='SRTB_'+data.id;data.popup=6;data.w=320;data.h=50;result=this.sapeRTBDrawBannerPopup(dv,data,partner);if(result===0){document.body.appendChild(dv);}}else{result=this.sapeRTBInsertStubElement(dv,data);}if(result===0&&btw){document.body.appendChild(dv);}return result;};SapeRtbClientCode.prototype.sapeRTBInsertSasElement=function(p,data){w=window;if(typeof data.htmlData==='undefined'){var fl=0,win=window,u=null;try{u=encodeURIComponent(w.top.location.toString());}catch(e){};while(win!=win.top){fl++;win=win.parent;}if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].sc_id!=='undefined'){var src='//ssp-rtb.sape.ru/data/?callback=sapeRTBreadResponse&srtbid='+this.srtbid+'&scids='+data.branches_data[data.branch_number].sc_id+'&sx='+(w.innerWidth||w.document.documentElement.clientWidth||w.document.body.clientWidth)+'&sy='+(w.innerHeight||w.document.documentElement.clientHeight||w.document.body.clientHeight)+'&ref='+encodeURIComponent(w.document.referrer)+(u!==null?'&u='+u:'')+'&allimps=0'+'&fl='+fl+'&tz='+this.common.encodeUriParam(this.common.getTimeZoneOffsetIso8601()),script=w.document.createElement('script');script.src=src;script.async=true;script=this.addScriptLoadListener(script,data.id,null);document.body.appendChild(script);}for(var b=0;b<this.ads.length;b++){if(this.ads[b].id===data.id){this.ads[b].sas_waiting=true;var that=this;setTimeout(function(){that.sapeRTBSkipSas();},5000,data.id);}}}else{if(p===null&&data.mobile){p=document.createElement('div');p.id='SRTB_'+data.id;var acl=document.createElement('a'),sectionId=data.id,sasId=this.sas;acl.innerHTML='<img style="border:0;outline:none;width:32px;height:32px;" src="//cdn-rtb.sape.ru/rtb-b/i/close.png">';acl.style.position='absolute';acl.style.border=0;acl.style.outline='none';acl.style.zIndex=2147483647;acl.style.display="block";acl.style.right='0px';acl.style.top='0px';acl.href='#';acl.className='SRTB_CLOSE';var ifr=this.common.createIFrame('SRTB_PARTNER_'+data.id,w.innerWidth,w.innerHeight);ifr.style.display='block';ifr.style.position='fixed';ifr.style.top='0px';ifr.style.left='0px';ifr.style.zIndex=2147483646;ifr.style.width=w.innerWidth;ifr.style.height=w.innerHeight;p.appendChild(acl);p.appendChild(ifr);document.body.appendChild(p);this.common.addEventListenerCrossBrowser(this.common.firstChildTag(p),'click',this.sapeRTBClosePopup);this.common.evalNode(p);this.common.onIFrameDocumentReady('SRTB_PARTNER_'+data.id,function(d){d.open();d.write(data.htmlData);d.close();},function(){var msg={provider:'sRTBMsg',act:'showNext',partner_id:sasId,sectionId:sectionId},win=window;win.postMessage(JSON.stringify(msg),'*');while(win!=win.parent){win=win.parent;win.postMessage(JSON.stringify(msg),'*');}});}else if(p!==null&&data.type==this.type_video){this.sapeRTBInsertSasVideoElement(p,data)}else{p.innerHTML=p.innerHTML+data.htmlData;this.common.evalNode(p);}for(var b=0;b<this.ads.length;b++){if(this.ads[b].id===data.id){this.ads[b].sas_waiting=false;}}}return 0;};SapeRtbClientCode.prototype.sapeRTBInsertSasVideoElement=function(p,data){var id='SRTB_VIDEO_'+data.id,width=data.w,height=data.h,partner_id=this.sas,pid=data.id;p.appendChild(this.common.createIFrame(id,width,height));this.common.onIFrameDocumentReady(id,function(d){d.open();d.write("<html>"+"<head>"+"<link rel='stylesheet' href='//cdn-rtb.sape.ru/js/videojs/video-js.min.css' />"+"<script src='//cdn-rtb.sape.ru/js/videojs/video.min.js' type='text/javascript'></script>"+"</head>"+"<body marginwidth='0' marginheight='0'>"+"<video muted id='"+id+"' autoplay preload='auto' ></video>"+"<script type='text/javascript'>"+"(function(){\n"+"   videojs('"+id+"', {sources: "+JSON.stringify(data.htmlData.video)+"}, function() {\n"+"       var player = this;\n"+"       player.on('ended', function() {\n"+"           if('"+data.htmlData.end+"' != '') {\n"+"               var img = document.createElement('img');\n"+"               img.src = '"+data.htmlData.end+"';\n"+"               document.body.appendChild(img);\n"+"           }\n"+"       });\n"+"       player.on('play', function() {\n"+"           if('"+data.htmlData.start+"' != '') { "+"               var img = document.createElement('img');\n"+"               img.src = '"+data.htmlData.start+"';\n"+"               document.body.appendChild(img);\n"+"           }\n"+"       });\n"+"       player.on('mouseover', function(){player.muted(false)});\n"+"       player.on('mouseout', function(){player.muted(true)});\n"+"   });\n"+"})();"+"</script>"+"</body>"+"</html>");d.close();},function(){var msg={provider:'sRTBMsg',act:'showNext',partner_id:partner_id,sectionId:pid},win=window;win.postMessage(JSON.stringify(msg),'*');while(win!=win.parent){win=win.parent;win.postMessage(JSON.stringify(msg),'*');}});};SapeRtbClientCode.prototype.runSasPlaces=function(){var result=1,w=window;if(this.srtbid>0&&this.sasIds.length>0){var scids=this.sasIds.join();if(scids!=''){var fl=0,win=window,u=null;try{u=encodeURIComponent(w.top.location.toString());}catch(e){};while(win!=win.top){fl++;win=win.parent;}var src='//ssp-rtb.sape.ru/data/?callback=sapeRTBreadResponse&srtbid='+this.srtbid+'&scids='+scids+'&sx='+w.innerWidth+'&sy='+w.innerHeight+'&ref='+encodeURIComponent(w.document.referrer)+(u!==null?'&u='+u:'')+'&allimps=1'+'&fl='+fl+'&tz='+this.common.encodeUriParam(this.common.getTimeZoneOffsetIso8601()),script=document.createElement('script');script.src=src;script=this.addScriptLoadListener(script,this.sas,'partnerId');document.body.appendChild(script);result=0;}}return result;};SapeRtbClientCode.prototype.sapeRTBSkipSas=function(id){try{for(var b=0;b<this.ads.length;b++){if(this.ads[b].id==id&&this.ads[b].sas_waiting){this.ads[b].sas_waiting=false;var ad=this.ads[b];if(typeof ad.branch_number!=='undefined'&&typeof ad.partner_number!=='undefined'&&typeof ad.branches[ad.branch_number]!=='undefined'&&ad.branches[ad.branch_number][ad.partner_number]==this.sas){console.log('Sas timeout');this.sapeRTBTrackingCode(ad,this.pix_err);var type='sectionId';var msg={provider:'sRTBMsg',act:'showNext',partner_id:this.sas};msg[type]=id;var w=window;w.postMessage(JSON.stringify(msg),'*');while(w!=w.parent){w=w.parent;w.postMessage(JSON.stringify(msg),'*');}}}}}catch(e){this.sapeRTBTrackJsErrors(e.message,null,null,null,(e&&e.stack)?e:new Error(e.message));}};SapeRtbClientCode.prototype.sapeRTBInsertBtwElement=function(p,data,partner_id){if(this.common.sapeRTBisMobile()&&data.type!=this.type_mobile_video&&data.type!=this.type_mobile_float&&data.type!=this.type_mobile_fullscreen&&!this.isNG){return 2;}if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].btw_id==='undefined'){return 1;}if(typeof window.__adds_params__==='undefined'){window.__adds_params__={};}window.__adds_params__[data.branches_data[data.branch_number].btw_id]={subid:this.srtbuid+'.'+data.sections[data.branch_number][data.partner_number]};if(data.type==this.type_inpage){window.__adds_params__[data.branches_data[data.branch_number].btw_id].video_fallback='<scr'+'ipt type="text/javascript">'+"var id="+data.id+",type = 'sectionId'; var msg = {provider: 'sRTBMsg', act: 'showNext', partner_id: '"+partner_id+"'}; msg[type] = id; var w = window; w.postMessage(JSON.stringify(msg), '*'); while(w != w.parent){ w = w.parent; w.postMessage(JSON.stringify(msg), '*');}"+'</scr'+'ipt>';}var dv=document.createElement("div"),e=document.createElement("script");dv.id='b_script_'+data.branches_data[data.branch_number].btw_id;e.type="text/javascript";e.async=true;e.charset='UTF-8';e.src='//dispenser-rtb.sape.ru/sections/2/'+data.branches_data[data.branch_number].btw_id+'.js';if(data.popup&&window.addEventListener){window.addEventListener('message',function(event){if(event.data==="[object Object]"||(event.data.is_show&&event.data.section==data.branches_data[data.branch_number].btw_id&&!p.hasAttribute('data-hide'))){p.style.display='block'}},false);}e=this.addScriptLoadListener(e,data.id,null);dv.appendChild(e);p.appendChild(dv);return 0;};SapeRtbClientCode.prototype.sapeRTBInsertBtw2Element=function(p,data){if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].btw2_id==='undefined'){return 1;}var btw_data=this.common.clone(data);btw_data.branches_data[btw_data.branch_number].btw_id=data.branches_data[data.branch_number].btw2_id;return this.sapeRTBInsertBtwElement(p,btw_data,this.btw2);};SapeRtbClientCode.prototype.sapeRTBInsertBtwCpmElement=function(p,data){if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].btw_cpm_id==='undefined'){return 1;}var btw_data=this.common.clone(data);btw_data.branches_data[btw_data.branch_number].btw_id=data.branches_data[data.branch_number].btw_cpm_id;return this.sapeRTBInsertBtwElement(p,btw_data,this.btw_cpm);};SapeRtbClientCode.prototype.sapeRTBInsertBtw2CpmElement=function(p,data){if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].btw2_cpm_id==='undefined'){return 1;}var btw_data=this.common.clone(data);btw_data.branches_data[btw_data.branch_number].btw_id=data.branches_data[data.branch_number].btw2_cpm_id;return this.sapeRTBInsertBtwElement(p,btw_data,this.btw2_cpm);};SapeRtbClientCode.prototype.sapeRTBInsertAdvrElement=function(p,data){if(this.common.sapeRTBisMobile()&&!this.isNG){return 2;}if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].advr_id==='undefined'){return 1;}var advr_id=data.branches_data[data.branch_number].advr_id,pid=data.id,id='SRTB_ADVR_'+data.id,advr=this.advr;p.appendChild(this.common.createIFrame(id,data.w,data.h));this.common.onIFrameDocumentReady(id,function(d){d.open();d.write("<html>"+"<head></head>"+"<body marginwidth='0' marginheight='0'>"+"<script type='text/javascript' src='//ddnk.advertur.ru/v1/code.js?id="+advr_id+"'></script>"+"</body>"+"</html>");d.close();},function(){var msg={provider:'sRTBMsg',act:'showNext',partner_id:advr,sectionId:pid},win=window;win.postMessage(JSON.stringify(msg),'*');while(win!=win.parent){win=win.parent;win.postMessage(JSON.stringify(msg),'*');}});return 0;};SapeRtbClientCode.prototype.sapeRTBInsertBtwChpElement=function(p,data){if(this.common.sapeRTBisMobile()&&!this.isNG){return 2;}if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].btw_chp_id==='undefined'){return 1;}var btw_id=data.branches_data[data.branch_number].btw_chp_id,rtb_id=data.branches_data[data.branch_number].btw_chp_rtb_id,id='SRTB_BTW_CHP_'+data.id,uid=this.srtbuid,btw_chp=this.btw_chp;p.appendChild(this.common.createIFrame(id,data.w,data.h));this.common.onIFrameDocumentReady(id,function(d){d.open();d.write("<html>"+"<head></head>\n"+"<body marginwidth='0' marginheight='0'>\n"+"<script type='text/javascript'>"+"window.__adds_params__ = {"+btw_id+" : {subid: '"+uid+"."+data.sections[data.branch_number][data.partner_number]+"'}};"+"</script>\n"+"<script type='text/javascript' async='async' charset='UTF-8' src='//dispenser-rtb.sape.ru/sections/2/"+btw_id+".js' "+'error="var msg = {provider: \'sRTBMsg\', act: \'showNext\'}, id, type; id = this.getAttribute(\'data-srtb-id\'); type = this.getAttribute(\'data-srtb-type\');'+"this.setAttribute(\'data-srtb-error\', 1); msg[type] = id; var w = window; w.postMessage(JSON.stringify(msg), \'*\'); while (w != w.parent) {"+'w = w.parent; w.postMessage(JSON.stringify(msg), \'*\');}" data-srtb-id="'+data.id+'" data-srtb-type="sectionId"></script>'+"<div id='b_script_"+btw_id+"' style='width:"+data.w+"px;height:"+data.h+"px;'></div>\n"+"<script type='text/javascript'>"+"function addEventListenerCrossBrowser(target, type, handler) {"+"if (target.addEventListener) { target.addEventListener(type, handler, false);} "+"else if (target.attachEvent) { target.attachEvent('on' + type, function (event) {handler.call(target, event)});}"+"else {throw 'Cannot add event listener: no Event API support in client';}}"+"var messageListener = function(e) {"+"var eventData,w = window;try {eventData = JSON.parse(e.data);} catch (err) {eventData = e.data;}"+"if (eventData && eventData.provider !== undefined && eventData.provider !== null && eventData.provider == 'sRTBMsg' && "+rtb_id+" == eventData.sectionId) {"+"if (eventData.act !== undefined && eventData.act !== null && eventData.act == 'showNext') {"+"var id="+data.id+",type = 'sectionId';"+"var msg = {provider: 'sRTBMsg', act: 'showNext', partner_id: '"+btw_chp+"'}; msg[type] = id; var w = window; w.postMessage(JSON.stringify(msg), '*');"+"while(w != w.parent){ w = w.parent; w.postMessage(JSON.stringify(msg), '*');}"+"} } }; addEventListenerCrossBrowser(window, 'message', messageListener);"+"</script>\n"+"</body>"+"</html>");d.close();},function(){console.log(id+' timeout');});if(data.popup&&window.addEventListener){window.addEventListener('message',function(event){if(event.data==="[object Object]"||(event.data.is_show&&event.data.section==btw_id&&!p.hasAttribute('data-hide'))){p.style.display='block'}},false);}return 0;};SapeRtbClientCode.prototype.sapeRTBInsertTmlElement=function(p,data){if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].tml_size==='undefined'){return 2;}var size=data.branches_data[data.branch_number].tml_size;if(this.tml_sizes[size]=='240x400'){if(data.w==300&&data.h==250&&(this.tml_teaser_slots.indexOf(data.tml_slot)+1)){p.style.overflow='hidden';}else if(data.w!=240||data.h!=400){return 2;}}else if(data.w+'x'+data.h!=this.tml_sizes[size]){return 1;}if(data.branches_data[data.branch_number].tml_slot==='undefined'){return 1;}var ins=document.createElement('ins'),loader=document.createElement('script'),add_script=false,script;if(!document.getElementById('SRTB_TML__78547')){script=document.createElement('script');script.src="//ad.mail.ru/static/ads-async.js";script.id='SRTB_TML__78547';add_script=true;}else{script=document.getElementById('SRTB_TML__78547');if(script.dataset&&script.dataset.srtbError){return 1;}else if(script.getAttribute('data-srtb-error')==1){return 1;}}if(ins.dataset){ins.dataset.adClient='ad-'+data.branches_data[data.branch_number].tml_slot;ins.dataset.adSlot=data.branches_data[data.branch_number].tml_slot;}ins.setAttribute('data-ad-slot',data.branches_data[data.branch_number].tml_slot);ins.setAttribute('data-ad-client','ad-'+data.branches_data[data.branch_number].tml_slot);ins.setAttribute('data-placeid',data.id);var query='count=2';if(data.branches_data[data.branch_number].tml_cpm>0){query+='&cpm_limit='+data.branches_data[data.branch_number].tml_cpm}query+='&sitename='+data.sections[data.branch_number][data.partner_number];ins.setAttribute('data-ad-query',query);ins.setAttribute('data-ad-sitename',data.sections[data.branch_number][data.partner_number]);if(ins.dataset){ins.dataset.adQuery=query;}ins.className='mrg-tag';loader.text="(MRGtag = window.MRGtag || []).push({onNoAds: function(){var id = arguments[0].el.getAttribute('data-placeid'), type = 'sectionId';var msg = {provider: 'sRTBMsg', act: 'showNext', partner_id: '"+data.branches_data[data.branch_number].tml_id+"'}; msg[type] = id; var w = window; w.postMessage(JSON.stringify(msg), '*'); while(w != w.parent){ w = w.parent; w.postMessage(JSON.stringify(msg), '*');}}, onAdsClicked: function(){console.log('arguments:' + arguments);}})";if(add_script){script=this.addScriptLoadListener(script,data.branches_data[data.branch_number].tml_id,'partnerId');document.body.appendChild(script);}p.appendChild(ins);p.appendChild(loader);return 0;};SapeRtbClientCode.prototype.sapeRTBInsertTmlCpmElement=function(p,data){if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].tml_cpm_size==='undefined'){return 2;}var tml_data=this.common.clone(data);tml_data.branches_data[tml_data.branch_number].tml_size=data.branches_data[data.branch_number].tml_cpm_size;tml_data.branches_data[tml_data.branch_number].tml_slot=data.branches_data[data.branch_number].tml_cpm_slot;tml_data.branches_data[tml_data.branch_number].tml_cpm=data.branches_data[data.branch_number].tml_cpm_cpm;tml_data.branches_data[tml_data.branch_number].tml_id=data.branches_data[data.branch_number].tml_cpm_id;return this.sapeRTBInsertTmlElement(p,tml_data);};SapeRtbClientCode.prototype.sapeRTBInsertMmbElement=function(p,data){if(typeof data.site_id==='undefined'||typeof data.params==='undefined'){return 1;}if(this.mmb_added){return 2;}var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//ssp.onemobsp.ru/?theme="+data.theme_id+"&id="+data.site_id+data.params;var t=document.getElementsByTagName("script")[0];e=this.addScriptLoadListener(e,data.id,null);t.parentNode.insertBefore(e,t);this.mmb_added=true;return 0;};SapeRtbClientCode.prototype.sapeRTBInsertCrtElement=function(p,data){if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].crt_zn_id==='undefined'){return 1;}var d=document.createElement("div"),zn_id=data.branches_data[data.branch_number].crt_zn_id;d.id='crt-'+data.branches_data[data.branch_number].crt_zn_id;p.appendChild(d);var displayAd=function(){var s=document.createElement("script");s.type="text/javascript";s.text='var crtLoader'+zn_id+' = function(n) { if(typeof Criteo !== "undefined") { Criteo.DisplayAd({"zoneid": '+zn_id+', "containerid":"crt-'+zn_id+'"});} else if(n > 0){ setTimeout(crtLoader'+zn_id+', 100, --n); } else {'+'var msg = {provider: "sRTBMsg", act: "showNext", partner_id: "'+SapeRtbClientCode.crt+'", sectionId: '+data.id+'};'+'w.postMessage(JSON.stringify(msg), "*"); while(w != w.parent){ w = w.parent; w.postMessage(JSON.stringify(msg), "*");} } }; crtLoader'+zn_id+'(10);';p.appendChild(s);};if(typeof Criteo!=='undefined'){displayAd();}else{var e=document.getElementById('SRTB_CRT_78547');if(!e){e=document.createElement("script");e.type="text/javascript";e.async=true;e.src=('//static.criteo.net/js/ld/publishertag.js');e.id='SRTB_CRT_78547';e=this.addScriptLoadListener(e,data.id,null);p.appendChild(e);}this.common.addEventListenerCrossBrowser(e,'load',displayAd);}return 0;};SapeRtbClientCode.prototype.sapeRTBInsertStubElement=function(p,data){var stubs=new Array(),has_stub_partner=false;if(data.partner_number==0){if(typeof data.admin_stubs!=='undefined'){stubs=data.admin_stubs;}else if(typeof data.stubs!=='undefined'){stubs=data.stubs;}}else{for(var i=0;i<data.branches.length;i++){if(data.branches[i][0]==0){has_stub_partner=true;}}if(typeof data.admin_stubs!=='undefined'&&!has_stub_partner){stubs=stubs.concat(data.admin_stubs);}if(typeof data.stubs!=='undefined'){stubs=stubs.concat(data.stubs);}}if(stubs.length==0){return 2;}var stub=stubs[Math.floor(Math.random()*stubs.length)];if(stub.async==1){p.innerHTML=stub.html;this.common.evalNode(p);}else{this.sapeRTBInsertStubSyncElement(p,stub.html,data.w,data.h);}return 0;};SapeRtbClientCode.prototype.sapeRTBInsertStubSyncElement=function(p,html,width,height){var id='FRAME_'+p.id;p.appendChild(this.common.createIFrame(id,width,height));window.sapeDrawUserBanner=function(n,id,html){var d;try{if(document.all&&!window.opera){d=window.frames[id].document;}else if(document.getElementById){d=document.getElementById(id).contentDocument;}}catch(e){;}if(n>0){if(typeof d==='undefined'){setTimeout(sapeDrawUserBanner,100,--n,id,html);}else{d.open();d.write(html);d.close();}}};sapeDrawUserBanner(10,id,html);return 0;};SapeRtbClientCode.prototype.sapeRTBInsertYdxElement=function(p,data){var rnd=Math.random()*100,stubs=new Array(),has_stub_partner=false;if(typeof data.branches[data.branch_number][data.partner_number+1]=='undefined'||data.branches[data.branch_number][data.partner_number+1]==0){for(var i=0;i<data.branches.length;i++){if(data.branches[i][0]==0){has_stub_partner=true;}}if(typeof data.admin_stubs!=='undefined'&&!has_stub_partner){stubs=stubs.concat(data.admin_stubs);}if(typeof data.stubs!=='undefined'){stubs=stubs.concat(data.stubs);}if(stubs.length!=0&&rnd<50){return 2;}}else if(rnd<50){return 2;}if(this.ydx_sizes.indexOf(data.w+'x'+data.h)+1==0){return 1;}p.appendChild(this.common.createIFrame('FRAME_'+p.id,data.w,data.h,'//ssp-rtb.sape.ru/market/v2?size='+data.w+'x'+data.h+'&place_id='+data.id));return 0;};SapeRtbClientCode.prototype.sapeRTBInsertDatElement=function(p,data){if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].sc_dat_id==='undefined'){return 1;}var div=document.createElement('div'),id="DIV_DA_"+data.branches_data[data.branch_number].sc_dat_id+"_"+parseInt(Math.random()*1e3);div.id=id;div.className='directadvert-block directadvert-block-'+data.branches_data[data.branch_number].sc_dat_id;if("undefined"===typeof loaded_blocks_directadvert){window.loaded_blocks_directadvert=[];function n(){var e=loaded_blocks_directadvert.shift(),t=e.adp_id,r=e.div,i=document.createElement("script");i.type="text/javascript";i.async=true;i.charset="windows-1251";i.src="//code.directadvert.ru/data/"+t+".js?tag=sape_"+e.site_id+"_"+t+"_external_"+e.section_id+"&async=1&div="+r+"&t="+Math.random();i=window.sapeRtbHandler_78547.addScriptLoadListener(i,data.id,null);var s=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0];s.appendChild(i);var o=setInterval(function(){if(document.getElementById(r)&&document.getElementById(r).innerHTML&&loaded_blocks_directadvert.length){n();clearInterval(o)}},50)}setTimeout(n,100);}loaded_blocks_directadvert.push({adp_id:data.branches_data[data.branch_number].sc_dat_id,div:id,srtb_id:data.id,site_id:data.dat_id,section_id:data.sections[data.branch_number][data.partner_number]});p.appendChild(div);return 0;};SapeRtbClientCode.prototype.sapeRTBInsertDat2Element=function(p,data){if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].sc_dat2_id==='undefined'){return 1;}var div=document.createElement('div'),id="DIV_DA_"+data.branches_data[data.branch_number].sc_dat2_id+"_"+parseInt(Math.random()*1e3);div.id=id;div.className='directadvert-block directadvert-block-'+data.branches_data[data.branch_number].sc_dat2_id;if("undefined"===typeof loaded_blocks_directadvert){window.loaded_blocks_directadvert=[];function n(){var e=loaded_blocks_directadvert.shift(),t=e.adp_id,r=e.div,i=document.createElement("script");i.type="text/javascript";i.async=true;i.charset="windows-1251";i.src="//code.directadvert.ru/data/"+t+".js?tag=sape_"+e.site_id+"_"+t+"_external_"+e.section_id+"&async=1&div="+r+"&t="+Math.random();i=window.sapeRtbHandler_78547.addScriptLoadListener(i,data.id,null);var s=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0];s.appendChild(i);var o=setInterval(function(){if(document.getElementById(r).innerHTML&&loaded_blocks_directadvert.length){n();clearInterval(o)}},50)}setTimeout(n,100);}loaded_blocks_directadvert.push({adp_id:data.branches_data[data.branch_number].sc_dat2_id,div:id,srtb_id:data.id,site_id:data.dat2_id,section_id:data.sections[data.branch_number][data.partner_number]});p.appendChild(div);return 0;};SapeRtbClientCode.prototype.sapeRTBInsertMgidElement=function(p,data){var id='SRTB_MGID_'+p.id,mgidId={'120X600':635513,'300X250':635510,'300X600':635514,'970X90':635515,'240X400':635507,'468X60':635511,'160X600':635512,'728X90':635508}[data.w+'X'+data.h],sectionId=data.sections[data.branch_number][data.partner_number],mgid=this.mgid,pid=data.id,stub;stub=this.common.encode64("function sendMessage"+mgidId+"(e){var h=mg_ws"+mgidId+".onmessage; mg_ws"+mgidId+".readyState==mg_ws"+mgidId+".CLOSED&&(mg_ws"+mgidId+"=new WebSocket(mg_ws"+mgidId+"_location)),mg_ws"+mgidId+".onmessage=h,waitForSocketConnection"+mgidId+"(mg_ws"+mgidId+",function(){mg_ws"+mgidId+".send(e)})}function waitForSocketConnection"+mgidId+"(e,t){setTimeout(function(){return 1===e.readyState?void(null!=t&&t()):void waitForSocketConnection"+mgidId+"(e,t)},5)}; var mg_ws"+mgidId+"_location = 'wss://wsp.marketgid.com/ws'; mg_ws"+mgidId+" = new WebSocket(mg_ws"+mgidId+"_location), mg_ws"+mgidId+".onmessage = function (t) {postMessage(t.data);}, onmessage = function(e){sendMessage"+mgidId+"(e.data)}");if(typeof mgidId==='undefined'){return 2;}p.appendChild(this.common.createIFrame(id,data.w,data.h));this.common.onIFrameDocumentReady(id,function(d){d.open();d.write("<html>"+"<head></head>"+"<body marginwidth='0' marginheight='0'>"+"<div id='M360588Composite"+mgidId+"'><center> <a href='http://marketgid.com/' target='_blank'>...</a> </center></div>"+"<script>var s1 = "+sectionId+";</script>"+"<script type=\"text/javascript\">"+"(function () {"+"var d = new Date, script"+mgidId+" = document.createElement('script'),"+" mg_ws"+mgidId+" = {};"+"script"+mgidId+".type = 'text/javascript';"+"script"+mgidId+".charset = 'utf-8';"+"script"+mgidId+".src = '//jsc.marketgid.com/1/s/1.sape.ru."+mgidId+".js?t=' + d.getYear() + d.getMonth() + d.getDay() + d.getHours();"+"script"+mgidId+".onerror = function () { "+"mg_ws"+mgidId+" = new Worker(URL.createObjectURL(new Blob(['eval(atob(\""+stub+"\"))']), {type: 'application/javascript'})); "+"mg_ws"+mgidId+".onmessage = function (msg){window.eval(msg.data);}; "+"mg_ws"+mgidId+".postMessage('js|'+script"+mgidId+".src+'|M360588Composite"+mgidId+"|M360588Composite"+mgidId+"');};"+"document.body.appendChild(script"+mgidId+");"+"})();"+"</script>"+"</body>"+"</html> ");d.close();},function(){var msg={provider:'sRTBMsg',act:'showNext',partner_id:mgid,sectionId:pid},win=window;win.postMessage(JSON.stringify(msg),'*');while(win!=win.parent){win=win.parent;win.postMessage(JSON.stringify(msg),'*');}});return 0;};SapeRtbClientCode.prototype.sapeRTBInsertSmi2Element=function(p,data){var id='SRTB_SMI2_'+p.id,width=data.w,height=data.h,smi2Id={'300X250':90446,'300X600':90447,'970X90':90443,'160X600':90444,'240X400':90445}[data.w+'X'+data.h],sectionId=data.sections[data.branch_number][data.partner_number],smi2=this.smi2,pid=data.id;if(typeof smi2Id==='undefined'){return 2;}p.appendChild(this.common.createIFrame(id,width,height));this.common.onIFrameDocumentReady(id,function(d){d.open();d.write("<html>"+"<head></head>"+"<body marginwidth='0' marginheight='0'>"+"<div id='unit_"+smi2Id+"'><a href='http://smi2.ru/'> smi2.ru</a></div>\n"+"<script type='text/javascript' charset='utf-8'>\n"+"  (function() {\n"+"    var sc = document.createElement('script'); sc.type = 'text/javascript'; sc.async = true;\n"+"    sc.src = '//smi2.ru/data/js/"+smi2Id+".js?source_id="+sectionId+"'; sc.charset = 'utf-8';\n"+"    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(sc, s);\n"+"  }());\n"+"</script>\n"+"</body>"+"</html> ");d.close();},function(){var msg={provider:'sRTBMsg',act:'showNext',partner_id:smi2,sectionId:pid},win=window;win.postMessage(JSON.stringify(msg),'*');while(win!=win.parent){win=win.parent;win.postMessage(JSON.stringify(msg),'*');}});return 0;};SapeRtbClientCode.prototype.sapeRTBInsertGrcElement=function(p,data){if(this.grc_sizes.indexOf(data.w+'x'+data.h)+1==0){return 1;}p.appendChild(this.common.createIFrame('FRAME_'+p.id,data.w,data.h,'//ssp-rtb.sape.ru/guru/v1?size='+data.w+'x'+data.h+'&place_id='+data.id+'&section_id='+data.sections[data.branch_number][data.partner_number]));return 0;};SapeRtbClientCode.prototype.sapeRTBInsertWvd2Element=function(dv,data){if(this.wvd2_added){return 2;}var allowed_sizes={240:[400],300:[250,600]};if(typeof allowed_sizes[data.w]==='undefined'||!(allowed_sizes[data.w].indexOf(data.h)+1)){return 2;}dv.appendChild(this.common.createIFrame('WINVIDEO_'+data.id,data.w,data.h,'//uniontraff.com/index.php?r=view/player&host=bot.sape.ru'));this.wvd2_added=true;return 0;};SapeRtbClientCode.prototype.sapeRTBInsertAdtsElement=function(dv,data){if(this.common.sapeRTBisMobile()&&!this.isNG){return 2;}if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].adts_js_key==='undefined'||!data.branches_data[data.branch_number].adts_js_key||typeof data.branches_data[data.branch_number].adts_pid==='undefined'||!data.branches_data[data.branch_number].adts_pid||typeof data.branches_data[data.branch_number].adts_desc==='undefined'||!data.branches_data[data.branch_number].adts_desc||typeof data.adts_id==='undefined'||typeof data.adts_stb==='undefined'){return 1;}var id='FRAME_'+data.sections[data.branch_number][data.partner_number],p_data={href:this.href,keywords:this.keywords,title:document.title};dv.appendChild(this.common.createIFrame(id,data.w,data.h));if(typeof window.sapeDrawAdtsBanner==='undefined'){window.sapeDrawAdtsBanner=function(n,id,b_data,ad_data,adts,p_data){var d;try{if(document.all&&!window.opera){d=window.frames[id].document;}else if(document.getElementById){d=document.getElementById(id).contentDocument;}}catch(e){}if(n>0){if(typeof d==='undefined'||d===null||(d.readyState!='interactive'&&d.readyState!='complete')){setTimeout(sapeDrawAdtsBanner,100,--n,id,b_data,ad_data,adts,p_data);}else{var sc=d.createElement('script'),data_sc=d.createElement('script'),loader=d.createElement('script'),div=d.createElement('div');data_sc.text='var adtagsParams_'+b_data.adts_js_key+' = {'+(b_data.adts_cpm>0?'"bidfloor":'+b_data.adts_cpm+',':'')+'"domainId":'+ad_data.adts_id+',"description":"'+b_data.adts_desc+'","pid":'+b_data.adts_pid+',"size":{"width":'+ad_data.w+',"height":'+ad_data.h+'},"passback":"'+ad_data.adts_stb+'", "publisherData":'+'{"href":"'+p_data.href+'", "keywords":"'+p_data.keywords+'", "title":"'+p_data.title+'"}}';div.id='adtagsParams_'+b_data.adts_js_key;sc.async="async";sc.id="adts_script";sc.src='https://cdn.adtags.pro/adtagsLoader_with_placeholder.js';loader.text="var target = document.getElementById('adts_script'), "+"call_loader = function(n){if(typeof adtagsLoader=== 'undefined'){if(n > 0) {setTimeout(call_loader, 100, --n)} else {"+"var msg = {provider: 'sRTBMsg', act: 'showNext', partner_id:"+adts+", 'sectionId': "+ad_data.pid+"};"+"var w = window; w.postMessage(JSON.stringify(msg), '*'); while (w != w.parent) { w = w.parent; w.postMessage(JSON.stringify(msg), '*'); }"+"}} else { adtagsLoader('adtagsParams_"+b_data.adts_js_key+"', adtagsParams_"+b_data.adts_js_key+");}}, "+"handler = function(){call_loader(10)}; "+"if (target.addEventListener) {target.addEventListener('load', handler, false);} "+"else if (target.attachEvent) {target.attachEvent('onload', function(event) {handler.call(target, event)});} "+"else { throw 'Cannot add event listener: no Event API support in client'}";d.body.appendChild(data_sc);d.body.appendChild(div);d.body.appendChild(sc);d.body.appendChild(loader);}}else{var msg={provider:'sRTBMsg',act:'showNext',partner_id:adts,sectionId:ad_data.pid},win=window;win.postMessage(JSON.stringify(msg),'*');while(win!=win.parent){win=win.parent;win.postMessage(JSON.stringify(msg),'*');}}};}sapeDrawAdtsBanner(10,id,data.branches_data[data.branch_number],data,SapeRtbClientCode.adts,p_data);return 0;};SapeRtbClientCode.prototype.sapeRTBInsertAdtsCpmElement=function(p,data){if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].adts_cpm_js_key==='undefined'||!data.branches_data[data.branch_number].adts_cpm_js_key||typeof data.branches_data[data.branch_number].adts_cpm_pid==='undefined'||!data.branches_data[data.branch_number].adts_cpm_pid||typeof data.branches_data[data.branch_number].adts_cpm_desc==='undefined'||!data.branches_data[data.branch_number].adts_cpm_desc||typeof data.adts_cpm_id==='undefined'||typeof data.adts_cpm_stb==='undefined'){return 1;}var adts_data=this.common.clone(data);adts_data.branches_data[adts_data.branch_number].adts_js_key=data.branches_data[data.branch_number].adts_cpm_js_key;adts_data.branches_data[adts_data.branch_number].adts_pid=data.branches_data[data.branch_number].adts_cpm_pid;adts_data.branches_data[adts_data.branch_number].adts_desc=data.branches_data[data.branch_number].adts_cpm_desc;adts_data.branches_data[adts_data.branch_number].adts_id=data.branches_data[data.branch_number].adts_cpm_id;adts_data.branches_data[adts_data.branch_number].adts_stb=data.branches_data[data.branch_number].adts_cpm_stb;adts_data.branches_data[adts_data.branch_number].adts_cpm=data.branches_data[data.branch_number].adts_cpm_cpm;return this.sapeRTBInsertAdtsElement(p,adts_data);};SapeRtbClientCode.prototype.sapeRTBInsertDatFloatElement=function(p,data){if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].sc_dat_id==='undefined'){return 1;}var div=document.createElement('div'),id="DIV_DA_"+data.branches_data[data.branch_number].sc_dat_id+"_"+parseInt(Math.random()*1e3),data_script=document.createElement("script");div.id=id;div.className='directadvert-block directadvert-block-'+data.branches_data[data.branch_number].sc_dat_id;if("undefined"===typeof loaded_blocks_directadvert){window.loaded_blocks_directadvert=[];function n(){var e=loaded_blocks_directadvert.shift();var t=e.adp_id;var r=e.div;var i=document.createElement("script");var id=e.srtb_id;i.type="text/javascript";i.async=true;i.charset="windows-1251";i.src="//code.directadvert.ru/data/"+t+".js?tag=sape_"+e.site_id+"_"+t+"_external_"+e.section_id+"&async=1&div="+r+"&t="+Math.random();i.onerror="var id ="+id+", type = 'sectionId'; var msg = {provider: 'sRTBMsg', act: 'showNext', partner_id: '"+this.dat+"'}; msg[type] = id; var w = window; w.postMessage(JSON.stringify(msg), '*'); while(w != w.parent){ w = w.parent; w.postMessage(JSON.stringify(msg), '*');}";var s=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0];s.appendChild(i);var o=setInterval(function(){if(document.getElementById(r).innerHTML&&loaded_blocks_directadvert.length){n();clearInterval(o)}},50)}setTimeout(n,100);}loaded_blocks_directadvert.push({adp_id:data.branches_data[data.branch_number].sc_dat_id,div:id,srtb_id:data.id,site_id:data.dat_id,section_id:data.sections[data.branch_number][data.partner_number]});data_script.type="text/javascript";data_script.text='__da_roll_in_settings = { time_to_show: '+data.float_tmt+', time_rotate: 60000, show_close: true, width_for_one: 300, time_move: 500, time_step_move: 100, time_step_speed: 1, background: "'+data.float_bg+'", color: "'+data.float_clr+'", shadow: 80, template : "img_top", height_banner: "30%"};';p.appendChild(data_script);p.appendChild(div);return 0;};SapeRtbClientCode.prototype.sapeRTBInsertDat2FloatElement=function(p,data){if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].sc_dat2_id==='undefined'){return 1;}var div=document.createElement('div'),id="DIV_DA_"+data.branches_data[data.branch_number].sc_dat2_id+"_"+parseInt(Math.random()*1e3),data_script=document.createElement("script");div.id=id;div.className='directadvert-block directadvert-block-'+data.branches_data[data.branch_number].sc_dat2_id;if("undefined"===typeof loaded_blocks_directadvert){window.loaded_blocks_directadvert=[];function n(){var e=loaded_blocks_directadvert.shift();var t=e.adp_id;var r=e.div;var i=document.createElement("script");var id=e.srtb_id;i.type="text/javascript";i.async=true;i.charset="windows-1251";i.src="//code.directadvert.ru/data/"+t+".js?tag=sape_"+e.site_id+"_"+t+"_external_"+e.section_id+"&async=1&div="+r+"&t="+Math.random();i.onerror="var id ="+id+", type = 'sectionId'; var msg = {provider: 'sRTBMsg', act: 'showNext', partner_id: '"+this.dat2+"'}; msg[type] = id; var w = window; w.postMessage(JSON.stringify(msg), '*'); while(w != w.parent){ w = w.parent; w.postMessage(JSON.stringify(msg), '*');}";var s=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0];s.appendChild(i);var o=setInterval(function(){if(document.getElementById(r).innerHTML&&loaded_blocks_directadvert.length){n();clearInterval(o)}},50)}setTimeout(n,100);}loaded_blocks_directadvert.push({adp_id:data.branches_data[data.branch_number].sc_dat2_id,div:id,srtb_id:data.id,site_id:data.dat2_id,section_id:data.sections[data.branch_number][data.partner_number]});data_script.type="text/javascript";data_script.text='__da_roll_in_settings = { time_to_show: '+data.float_tmt+', time_rotate: 60000, show_close: true, width_for_one: 300, time_move: 500, time_step_move: 100, time_step_speed: 1, background: "'+data.float_bg+'", color: "'+data.float_clr+'", shadow: 80, template : "img_top", height_banner: "30%"};';p.appendChild(data_script);p.appendChild(div);return 0;};SapeRtbClientCode.prototype.sapeRTBInsertMgidFloatElement=function(p,data){var mgidId=615405,div=document.createElement('div'),loading=document.createElement('div'),script=document.createElement('script'),param=document.createElement('script'),style=document.createElement('style'),css='.mgbox{background-color: '+data.float_bg+'; padding: 20px 0;}'+'.mgbox .mgline{width: 33.3333%; display: inline-block; text-align: center;}'+'.mgbox .mgline .text-elements a{color: '+data.float_clr+'}'+'.mgbox .mgline .text-elements .mctitle a{font-size: 16px; font-weight: bold; font-family: Arial;}'+'.mgbox .mgline .text-elements .mcdesc a{font-size:14px; font-family: Arial;}'+'.mgbox .mcclose {position: absolute;top: 5px;right: 5px;cursor: pointer;}'+'.mgbox .mcadvert615405{position: absolute;top: 5px;; right: 30px; font-size: 14px; line-height: 25px; font-family: Arial;}';div.id='M360588ScriptRootC'+mgidId;loading.id='M360588PreloadC'+mgidId;script.type="text/javascript";param.type="text/javascript";style.type="text/css";param.text='var SRTB_MGID_615405 = '+data.sections[data.branch_number][data.partner_number]+';';if(style.styleSheet){style.styleSheet.cssText=css;}else{style.appendChild(document.createTextNode(css));}script.text='setTimeout(function() {'+"var D = new Date(), d = document, b = 'body', ce = 'createElement', ac = 'appendChild', st = 'style', ds = 'display', n = 'none', gi = 'getElementById';"+'var iw = d; var c = d[gi]("M360588ScriptRootC'+mgidId+'");'+"var dv = iw[ce]('div');"+'dv.id = "MG_ID"; dv[st][ds] = n; dv.innerHTML = '+mgidId+'; c[ac](dv);'+"var s = iw[ce]('script'); s.async='async'; s.defer='defer'; s.charset='utf-8';"+'s.src = "//jsc.marketgid.com/1/s/1.sape.ru.'+mgidId+'.js?t=" + D.getYear() + D.getMonth() + D.getDate() + D.getHours();'+"(function(target, type, handler) {"+"    if (target.addEventListener) {"+"        target.addEventListener(type, handler, false);"+"    }else if (target.attachEvent) {"+"        target.attachEvent('on' + type, function(event) {handler.call(target, event)});"+"    }else {"+"        throw 'Cannot add event listener: no Event API support in client'"+"    }"+"})(s,'error',function (e) {"+"    var id="+data.id+",type = 'sectionId'; var msg = {provider: 'sRTBMsg', act: 'showNext', 'partner_id': '"+this.mgid+"'}; msg[type] = id; var w = window; w.postMessage(JSON.stringify(msg), '*'); while(w != w.parent){ w = w.parent; w.postMessage(JSON.stringify(msg), '*');}"+"});"+'c[ac](s); '+'}, '+data.float_tmt+');';div.appendChild(loading);div.appendChild(style);div.appendChild(param);div.appendChild(script);p.appendChild(div);return 0;};SapeRtbClientCode.prototype.sapeRTBInsertBtwFloatElement=function(p,data){if((this.common.sapeRTBisMobile()&&!this.isNG)||Math.max(document.documentElement.clientWidth,window.innerWidth||0)<970){return 2;}if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].btw_id==='undefined'){return 1;}if(typeof window.__adds_params__==='undefined'){window.__adds_params__={};}window.__adds_params__[data.branches_data[data.branch_number].btw_id]={subid:this.srtbuid+'.'+data.sections[data.branch_number][data.partner_number]};var dv=document.createElement("div"),wrapper=document.createElement('div'),block=document.createElement('div'),inner_block=document.createElement('div'),row_block=document.createElement('div'),cell_block=document.createElement('div'),close=document.createElement('a'),close_icon=document.createElement('img'),e=document.createElement("script"),w=window;wrapper.style.position='fixed';wrapper.style.backgroundColor=data.float_bg;wrapper.style.width='100%';wrapper.style.zIndex='9999';wrapper.style.display='block';wrapper.style.right='0px';wrapper.style.left='0px';wrapper.style.bottom='-286px';wrapper.style.margin='1px';wrapper.id='SRTB_BTW_FLOAT_'+data.id;close.style.position='absolute';close.style.border='0px';close.style.outline='none';close.style.zIndex='9999';close.style.display='block';close.style.right='-16px';close.style.top='-16px';close_icon.style.border='0px';close_icon.style.outline='none';close_icon.style.width='32px';close_icon.style.height='32px';close_icon.src="//cdn-rtb.sape.ru/rtb-b/i/close.png";close.appendChild(close_icon);this.common.addEventListenerCrossBrowser(close,'click',this.sapeRTBCloseFloat);wrapper.appendChild(close);block.style.position='relative';block.style.width='100%';block.style.height='260px';block.style.display='table';inner_block.style.position='relative';inner_block.style.maxWidth='950px';inner_block.style.margin='0 auto';inner_block.style.display='table';row_block.style.display='table-row';cell_block.style.verticalAlign='middle';cell_block.style.height='270px';cell_block.style.display='table-cell';dv.id='b_script_'+data.branches_data[data.branch_number].btw_id;e.type="text/javascript";e.async=true;e.charset='UTF-8';e.src='//dispenser-rtb.sape.ru/sections/2/'+data.branches_data[data.branch_number].btw_id+'.js';if(data.popup&&w.addEventListener){w.addEventListener('message',function(event){if(event.data==="[object Object]"||(event.data.is_show&&event.data.section==data.branches_data[data.branch_number].btw_id&&!p.hasAttribute('data-hide'))){p.style.display='block'}},false);}e=this.addScriptLoadListener(e,data.id,null);dv.appendChild(e);cell_block.appendChild(dv);row_block.appendChild(cell_block);inner_block.appendChild(row_block);block.appendChild(inner_block);wrapper.appendChild(block);p.appendChild(wrapper);window.btwFloatSlide=function(step,pause,id,attempts){if(window.srtbBtwFloatIsShow){var bottom=parseFloat(document.getElementById(id).style.bottom);if(bottom<0){document.getElementById(id).style.bottom=Math.min(bottom+step,0)+'px';setTimeout(btwFloatSlide,pause,++step,pause,id);}}else if(attempts){setTimeout(btwFloatSlide,250,step,pause,id,--attempts);}else if(window.srtbBtwFloatId){id=id.replace('SRTB_BTW_FLOAT_',''),type='sectionId';var msg={provider:'sRTBMsg',act:'showNext',partner_id:this.btw};msg[type]=id;var w=window;w.postMessage(JSON.stringify(msg),'*');while(w!=w.parent){w=w.parent;w.postMessage(JSON.stringify(msg),'*');}}};window.srtbBtwFloatId=data.branches_data[data.branch_number].btw_id;this.common.addEventListenerCrossBrowser(window,'message',function(e){var eventData;try{eventData=JSON.parse(e.data);}catch(err){eventData=e.data;}if(eventData.provider!==undefined&&eventData.provider=='between'&&eventData.section!==undefined&&eventData.section==window.srtbBtwFloatId){if(eventData.is_show==true){window.srtbBtwFloatIsShow=true;}}});setTimeout(btwFloatSlide,data.float_tmt,1,10,'SRTB_BTW_FLOAT_'+data.id,20);return 0;};SapeRtbClientCode.prototype.sapeRTBInsertBtw2FloatElement=function(p,data){if((this.common.sapeRTBisMobile()&&!this.isNG)||Math.max(document.documentElement.clientWidth,window.innerWidth||0)<970){return 2;}if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].btw2_id==='undefined'){return 1;}if(typeof window.__adds_params__==='undefined'){window.__adds_params__={};}window.__adds_params__[data.branches_data[data.branch_number].btw2_id]={subid:this.srtbuid+'.'+data.sections[data.branch_number][data.partner_number]};var dv=document.createElement("div"),wrapper=document.createElement('div'),block=document.createElement('div'),inner_block=document.createElement('div'),row_block=document.createElement('div'),cell_block=document.createElement('div'),close=document.createElement('a'),close_icon=document.createElement('img'),e=document.createElement("script");wrapper.style.position='fixed';wrapper.style.backgroundColor=data.float_bg;wrapper.style.width='100%';wrapper.style.zIndex='9999';wrapper.style.display='block';wrapper.style.right='0px';wrapper.style.left='0px';wrapper.style.bottom='-286px';wrapper.style.margin='1px';wrapper.id='SRTB_BTW_FLOAT_'+data.id;close.style.position='absolute';close.style.border='0px';close.style.outline='none';close.style.zIndex='9999';close.style.display='block';close.style.right='-16px';close.style.top='-16px';close_icon.style.border='0px';close_icon.style.outline='none';close_icon.style.width='32px';close_icon.style.height='32px';close_icon.src="//cdn-rtb.sape.ru/rtb-b/i/close.png";close.appendChild(close_icon);this.common.addEventListenerCrossBrowser(close,'click',this.sapeRTBCloseFloat);wrapper.appendChild(close);block.style.position='relative';block.style.width='100%';block.style.height='260px';block.style.display='table';inner_block.style.position='relative';inner_block.style.maxWidth='950px';inner_block.style.margin='0 auto';inner_block.style.display='table';row_block.style.display='table-row';cell_block.style.verticalAlign='middle';cell_block.style.height='270px';cell_block.style.display='table-cell';dv.id='b_script_'+data.branches_data[data.branch_number].btw2_id;e.type="text/javascript";e.async=true;e.charset='UTF-8';e.src='//dispenser-rtb.sape.ru/sections/2/'+data.branches_data[data.branch_number].btw2_id+'.js';if(data.popup&&window.addEventListener){window.addEventListener('message',function(event){if(event.data==="[object Object]"||(event.data.is_show&&event.data.section==data.branches_data[data.branch_number].btw2_id&&!p.hasAttribute('data-hide'))){p.style.display='block'}},false);}e=this.addScriptLoadListener(e,data.id,null);dv.appendChild(e);cell_block.appendChild(dv);row_block.appendChild(cell_block);inner_block.appendChild(row_block);block.appendChild(inner_block);wrapper.appendChild(block);p.appendChild(wrapper);window.btwFloatSlide=function(step,pause,id,attempts){if(window.srtbBtwFloatIsShow){var bottom=parseFloat(document.getElementById(id).style.bottom);if(bottom<0){document.getElementById(id).style.bottom=Math.min(bottom+step,0)+'px';setTimeout(btwFloatSlide,pause,++step,pause,id);}}else if(attempts){setTimeout(btwFloatSlide,250,step,pause,id,--attempts);}else if(window.srtbBtwFloatId){id=id.replace('SRTB_BTW_FLOAT_',''),type='sectionId';var msg={provider:'sRTBMsg',act:'showNext',partner_id:this.btw_2};msg[type]=id;var w=window;w.postMessage(JSON.stringify(msg),'*');while(w!=w.parent){w=w.parent;w.postMessage(JSON.stringify(msg),'*');}}};window.srtbBtwFloatId=data.branches_data[data.branch_number].btw2_id;this.common.addEventListenerCrossBrowser(window,'message',function(e){var eventData;try{eventData=JSON.parse(e.data);}catch(err){eventData=e.data;}if(eventData.provider!==undefined&&eventData.provider=='between'&&eventData.section!==undefined&&eventData.section==window.srtbBtwFloatId){if(eventData.is_show==true){window.srtbBtwFloatIsShow=true;}}});setTimeout(btwFloatSlide,data.float_tmt,1,10,'SRTB_BTW_FLOAT_'+data.id,20);return 0;};SapeRtbClientCode.prototype.sapeRTBInsertCrtFloatElement=function(p,data){if(this.common.sapeRTBisMobile()||Math.max(document.documentElement.clientWidth,window.innerWidth||0)<970){return 2;}if(typeof data.branches_data[data.branch_number]==='undefined'||typeof data.branches_data[data.branch_number].crt_zn_id==='undefined'){return 1;}var d=document.createElement("div"),wrapper=document.createElement('div'),block=document.createElement('div'),inner_block=document.createElement('div'),row_block=document.createElement('div'),cell_block=document.createElement('div'),close=document.createElement('a'),close_icon=document.createElement('img');wrapper.style.position='fixed';wrapper.style.backgroundColor=data.float_bg;wrapper.style.width='100%';wrapper.style.zIndex='9999';wrapper.style.display='block';wrapper.style.right='0px';wrapper.style.left='0px';wrapper.style.bottom='-286px';wrapper.style.margin='1px';wrapper.id='SRTB_CRT_FLOAT_'+data.id;close.style.position='absolute';close.style.border='0px';close.style.outline='none';close.style.zIndex='9999';close.style.display='block';close.style.right='-16px';close.style.top='-16px';close_icon.style.border='0px';close_icon.style.outline='none';close_icon.style.width='32px';close_icon.style.height='32px';close_icon.src="//cdn-rtb.sape.ru/rtb-b/i/close.png";close.appendChild(close_icon);this.common.addEventListenerCrossBrowser(close,'click',this.sapeRTBCloseFloat);wrapper.appendChild(close);block.style.position='relative';block.style.width='100%';block.style.height='260px';block.style.display='table';inner_block.style.position='relative';inner_block.style.maxWidth='950px';inner_block.style.margin='0 auto';inner_block.style.display='table';row_block.style.display='table-row';cell_block.style.verticalAlign='middle';cell_block.style.height='270px';cell_block.style.display='table-cell';d.id='crt-'+data.branches_data[data.branch_number].crt_zn_id;cell_block.appendChild(d);var displayAd=function(){var s=document.createElement("script");s.type="text/javascript";s.text='Criteo.DisplayAd({"zoneid": '+data.branches_data[data.branch_number].crt_zn_id+', "containerid":"crt-'+data.branches_data[data.branch_number].crt_zn_id+'"});';cell_block.appendChild(s);};if(typeof Criteo!=='undefined'){displayAd();}else{var e=document.getElementById('SRTB_CRT__78547');if(!e){e=document.createElement("script");e.type="text/javascript";e.src=('//static.criteo.net/js/ld/publishertag.js');e.id='SRTB_CRT__78547';e=this.addScriptLoadListener(e,data.id,null);cell_block.appendChild(e);}this.common.addEventListenerCrossBrowser(e,'load',displayAd);}row_block.appendChild(cell_block);inner_block.appendChild(row_block);block.appendChild(inner_block);wrapper.appendChild(block);p.appendChild(wrapper);window.btwFloatSlide=function(step,pause,id){var bottom=parseFloat(document.getElementById(id).style.bottom);if(bottom<0){document.getElementById(id).style.bottom=Math.min(bottom+step,0)+'px';setTimeout(btwFloatSlide,pause,++step,pause,id);}};setTimeout(btwFloatSlide,data.float_tmt,1,10,'SRTB_CRT_FLOAT_'+data.id);return 0;};SapeRtbClientCode.prototype.sapeRTBInsertCcdFloatElement=function(p,data){var attr={src:'https://static.clickscloud.net/ext/app/build.js',async:1,id:'clickscloud-support-script','data-config':'58ecd2c50bbda561eb5b715c'};var clicksCloud=document.createElement('script');Object.keys(attr).forEach(function(key){clicksCloud.setAttribute(key,attr[key]);});clicksCloud=this.addScriptLoadListener(clicksCloud,data.id,null);p.appendChild(clicksCloud);return 0;};SapeRtbClientCode.prototype.sapeRTBInsertWvdInpageElement=function(dv,data){if(this.wvd_added){return 2;}var scr=document.createElement('script'),div=document.createElement('div');scr.src='//utraff.com/index.php?r=js/contentroll&id=40&w=640&h=480';div.id='utCRoll';scr=this.addScriptLoadListener(scr,data.id,null);dv.appendChild(div);dv.appendChild(scr);this.wvd_added=true;return 0;};SapeRtbClientCode.prototype.sapeRTBInsertWvd2InpageElement=function(dv,data){if(this.wvd2_added){return 2;}var scr=document.createElement('script'),div=document.createElement('div');scr.src='//uniontraff.com/js/contentroll/?host=bot.sape.ru&w=640&h=480';div.id='wvScrollPlayer';scr=this.addScriptLoadListener(scr,data.id,null);dv.appendChild(div);dv.appendChild(scr);return 0;};SapeRtbClientCode.prototype.sapeRTBInsertOtmVideoElement=function(p,data){var id='SRTB_OTM_'+data.id,width=data.w,height=data.h,otm=this.otm,pid=data.id;p.appendChild(this.common.createIFrame(id,width,height));this.common.onIFrameDocumentReady(id,function(d){d.open();d.write("<html>"+"<head></head>"+"<body marginwidth='0' marginheight='0'>"+"<div id='mtdblock-URvsC'></div>"+"<script type='text/javascript'>"+" var mtddata_URvsC = {  placement_id: '59c9048290d4ca06a6cc529b', site_id: '58f0b87b93d32c3e1f4dd75d',"+" width: "+width+", height: "+height+"}; </script>"+"<script type='text/javascript' src='https://adserver.otm-r.com/scr/js/URvsC/start_script.js'></script>"+"</body>"+"</html> ");d.close();},function(){var msg={provider:'sRTBMsg',act:'showNext',partner_id:otm,sectionId:pid},win=window;win.postMessage(JSON.stringify(msg),'*');while(win!=win.parent){win=win.parent;win.postMessage(JSON.stringify(msg),'*');}});return 0;};SapeRtbClientCode.prototype.sapeRTBInsertWvdVideoElement=function(dv,data){if(this.wvd_added){return 2;}dv.appendChild(this.common.createIFrame('WINVIDEO_'+data.id,600,340,'//new.utraff.com/index.php?r=iframe/index&id=40'));setTimeout("if(!window.sapeRtbHandler_78547.wvd_shown){var id="+data.id+",type = 'sectionId'; var msg = {provider: 'sRTBMsg', act: 'showNext', 'partner_id': '"+this.wvd+"'}; msg[type] = id; var w = window; w.postMessage(JSON.stringify(msg), '*'); while(w != w.parent){ w = w.parent; w.postMessage(JSON.stringify(msg), '*');}}",15*1000);this.wvd_added=true;return 0;};SapeRtbClientCode.prototype.sapeRTBInsertVdpkVideoElement=function(dv,data){if(this.vdpk_mob_added||this.vdpk_added){return 2;}dv.appendChild(this.common.createIFrame('adv_kod_frame',600,320,'//videopotok.pro/kod.php?param=3775325a754a72644d584d6b7379502f42595a67473742516b496a4c3852353377676a436f41595544556b3d'));var sc=document.createElement('script');sc.type='text/javascript';sc.src='//videopotok.pro/player_html5/iframeobrabotchik.js';sc=this.addScriptLoadListener(sc,data.id,null);dv.appendChild(sc);this.vdpk_added=true;return 0;};SapeRtbClientCode.prototype.sapeRTBInsertWvd2VideoElement=function(dv,data){if(this.wvd2_added){return 2;}dv.appendChild(this.common.createIFrame('WINVIDEO_'+data.id,600,340,'//uniontraff.com/index.php?r=view/player&host=bot.sape.ru'));setTimeout("if(!window.sapeRtbHandler_78547.wvd2_shown){var id="+data.id+",type = 'sectionId'; var msg = {provider: 'sRTBMsg', act: 'showNext', 'partner_id': '"+this.wvd2+"'}; msg[type] = id; var w = window; w.postMessage(JSON.stringify(msg), '*'); while(w != w.parent){ w = w.parent; w.postMessage(JSON.stringify(msg), '*');}}",15*1000);this.wvd2_added=true;return 0;};SapeRtbClientCode.prototype.sapeRTBInsertVdpkMobileVideoElement=function(dv,data){if(this.vdpk_mob_added||this.vdpk_added){return 2;}dv.appendChild(this.common.createIFrame('mob_vpotok_frame','100%','100%','//videopotok.pro/mobilauth.php?param=79683175395142513535586559746c35753063695074595946317232493044353568615a2f36303d'));var sc=document.createElement('script');sc.type='text/javascript';sc.src='//videopotok.pro/player_html5/mobileobrab.js';sc=this.addScriptLoadListener(sc,data.id,null);dv.appendChild(sc);this.vdpk_mob_added=true;return 0;};SapeRtbClientCode.prototype.sapeRTBInsertOtmMobileFullscreenElement=function(dv,data){var sc=document.createElement('script'),div=document.createElement('div');sc.type='text/javascript';sc.src='//adserver.otm-r.com/js/show.js?srtb_place_id='+data.id;sc=this.addScriptLoadListener(sc,data.id,null);div.className='mtdblock';div.setAttribute('site_id','58f0b87b93d32c3e1f4dd75d');div.setAttribute('placement_id','58f0b92293d32c3e1f4dd75e');div.setAttribute('srtb_place_id',data.id);sc=this.addScriptLoadListener(sc,data.id,null);dv.appendChild(div);dv.appendChild(sc);return 0;};SapeRtbClientCode.prototype.addScriptLoadListener=function(script,id,type){if(type==null){type='sectionId';}script.setAttribute('data-srtb-id',id);script.setAttribute('data-srtb-type',type);if(script.dataset){script.dataset.srtbId=id;script.dataset.srtbType=type;}this.common.addEventListenerCrossBrowser(script,'error',function(e){var msg={provider:'sRTBMsg',act:'showNext'},id,type;if(this.dataset){id=this.dataset.srtbId;type=this.dataset.srtbType;this.dataset.srtbError=1;}else{id=this.getAttribute('data-srtb-id');type=this.getAttribute('data-srtb-type');this.setAttribute('data-srtb-error',1);}msg[type]=id;var w=window;w.postMessage(JSON.stringify(msg),'*');while(w!=w.parent){w=w.parent;w.postMessage(JSON.stringify(msg),'*');}});return script;};SapeRtbClientCode.prototype.runPlace=function(b,rnd){if((this.ads[b].mobile&&!this.common.sapeRTBisMobile())||(this.ads[b].float&&this.common.sapeRTBisMobile())){return true;}if(this.ads[b].float&&!this.common.sapeRTBisMobile()){return this.branchCodeStd(this.ads[b],'7,0');}else{if(this.ads[b].type==this.type_video){return this.branchCodeStd(this.ads[b],'53,0');}else{if(this.ads[b].type==this.type_inpage){if(rnd<=50){return this.branchCodeStd(this.ads[b],'7,53,0');}else 
                if(rnd<=100){return this.branchCodeStd(this.ads[b],'53,7,0');}}else{if(this.ads[b].type==this.type_mobile_float){return this.branchCodeStd(this.ads[b],'307,7,0');}else{if(this.ads[b].type==this.type_mobile_video){return this.branchCodeStd(this.ads[b],'46,0');}else{if(this.ads[b].type==this.type_mobile_fullscreen){if(rnd<=95){return this.branchCodeStd(this.ads[b],'307,7,46,0');}else 
                if(rnd<=100){return this.branchCodeStd(this.ads[b],'307,68,7,46,0');}}else{if(rnd<=88){return this.branchCodeStd(this.ads[b],'16,307,183,132,7,32,83,0');}if(rnd<=90){return this.branchCodeStd(this.ads[b],'307,183,132,7,32,83,16,0');}if(rnd<=92){return this.branchCodeStd(this.ads[b],'183,132,7,32,83,16,307,0');}if(rnd<=94){return this.branchCodeStd(this.ads[b],'132,7,32,83,16,307,183,0');}if(rnd<=96){return this.branchCodeStd(this.ads[b],'7,32,83,16,307,183,132,0');}if(rnd<=98){return this.branchCodeStd(this.ads[b],'32,83,16,307,183,132,7,0');}if(rnd<=100){return this.branchCodeStd(this.ads[b],'83,16,307,183,132,7,32,0');}}}}}}}};SapeRtbClientCode.prototype.messageListener=function(e){var eventData,w=window;try{eventData=JSON.parse(e.data);}catch(err){eventData=e.data;}var origin=e.origin||e.originalEvent.origin,sapeRtbHandler=w.sapeRtbHandler_78547,ad;try{var b=0,el;if(origin.indexOf('uniontraff.com')>=0&&e.data=='no_ads'){w.postMessage(JSON.stringify({provider:'sRTBMsg',act:'showNext',partnerId:sapeRtbHandler.wvd}),'*');}else if(origin.indexOf('utraff.com')>=0&&eventData=='no_ads'){w.postMessage(JSON.stringify({provider:'sRTBMsg',act:'showNext',partnerId:sapeRtbHandler.wvd}),'*');}else if(origin.indexOf('utraff.com')>=0&&eventData=='show_ad'){for(b=0;b<sapeRtbHandler.ads.length;b++){ad=sapeRtbHandler.ads[b];if(typeof ad.branches!=='undefined'&&typeof ad.branches_data[ad.branches]!=='undefined'&&typeof ad.branches[ad.branch_number][ad.partner_number]!=='undefined'&&ad.branches[ad.branch_number][ad.partner_number]==sapeRtbHandler.wvd){sapeRtbHandler.sapeRTBTrackingCode(ad,sapeRtbHandler.pix_ad);sapeRtbHandler.wvd_shown=true;}}}else if(origin.indexOf('videopotok.pro')>=0&&eventData=='no_reklam_vid'){for(b=0;b<sapeRtbHandler.ads.length;b++){ad=sapeRtbHandler.ads[b];if(typeof ad.branches!=='undefined'&&typeof ad.branches[ad.branch_number]!=='undefined'&&typeof ad.branches[ad.branch_number][ad.partner_number]!=='undefined'&&ad.branches[ad.branch_number][ad.partner_number]==sapeRtbHandler.vdpk){w.postMessage(JSON.stringify({provider:'sRTBMsg',act:'showNext',partnerId:sapeRtbHandler.vdpk,sectionId:ad.id}),'*');w.postMessage(JSON.stringify({provider:'SRTB_WinVideo',act:'noads'}),'*');var win=w;while(win!=win.parent){win.postMessage(JSON.stringify({provider:'SRTB_WinVideo',act:'noads'}),'*');win=win.parent;}}}}else if(typeof eventData!=='undefined'&&eventData!==null&&eventData.provider!==undefined&&eventData.provider!==null){if(eventData.provider=='between'&&eventData.section&&eventData.errors!==undefined&&eventData.errors.length){for(b=0;b<sapeRtbHandler.ads.length;b++){ad=sapeRtbHandler.ads[b];if(typeof ad.branches_data!=='undefined'&&typeof ad.branches_data[ad.branch_number]!=='undefined'&&(ad.branches_data[ad.branch_number].btw_id==eventData.section||ad.branches_data[ad.branch_number].btw2_id==eventData.section)){var partner_id=ad.branches_data[ad.branch_number].btw_id==eventData.section?sapeRtbHandler.btw:sapeRtbHandler.btw2;w.postMessage(JSON.stringify({provider:'sRTBMsg',act:'showNext',sectionId:ad.id,partner_id:partner_id}),'*');}}}else if(eventData.provider=='sRTBMsg'){if(eventData.act!==undefined&&eventData.act!==null){if(eventData.act=='showNext'||eventData.act=='rfrsh'){for(b=0;b<sapeRtbHandler.ads.length;b++){ad=sapeRtbHandler.ads[b];if((typeof ad.branches_data!=='undefined'&&typeof eventData.sectionId!=='undefined'&&ad.id==eventData.sectionId)||(typeof ad.branches_data!=='undefined'&&typeof eventData.sectionId=='undefined'&&typeof eventData.partnerId!=='undefined'&&ad.current_partner==eventData.partnerId)){if(typeof ad.partner_number=='undefined'){return;}if(typeof eventData.partner_id!='undefined'&&ad.branches[ad.branch_number][ad.partner_number]!=eventData.partner_id&&eventData.partner_id!=sapeRtbHandler.adts&&ad.branches[ad.branch_number][ad.partner_number]!=sapeRtbHandler.adts_cpm){return;}if(eventData.act=='rfrsh'){if((typeof ad.branches[ad.branch_number][ad.partner_number+1]=='undefined'||ad.branches[ad.branch_number][ad.partner_number+1]==0)){if(!ad.popup||!ad.popup_closed){sapeRtbHandler.rtt(ad,0,true,b);}return;}}var was_shown=false,noad=true;if(typeof eventData.reason!=='undefined'&&eventData.reason=='scriptError'){sapeRtbHandler.sapeRTBTrackingCode(ad,sapeRtbHandler.pix_err);}while(!was_shown){sapeRtbHandler.ads[b].partner_number++;if(noad){if(ad.branches[ad.branch_number][ad.partner_number-1]!=sapeRtbHandler.wvd||!sapeRtbHandler.wvd_shown){if(eventData.act!='rfrsh'){var current_partner=ad.branches[ad.branch_number][ad.partner_number-1];if(typeof ad.shown!=='undefined'&&(ad.shown.indexOf(current_partner)+1)){sapeRtbHandler.ads[b].shown.splice(ad.shown.indexOf(current_partner),1);}}sapeRtbHandler.sapeRTBTrackingCode(ad,sapeRtbHandler.pix_noad);}noad=false;}if(typeof ad.branches[ad.branch_number][ad.partner_number]=='undefined'){el=document.getElementById('SRTB_'+eventData.sectionId);if(el){el.style.display='none';el.setAttribute('data-hide','1');}break;}else{el=document.getElementById('SRTB_'+ad.id);if(el){if(!ad.popup&&!ad.mobile&&!ad.float){var new_el=el.cloneNode(false);sapeRtbHandler.common.insertAfter(el,new_el);}else if(ad.float){sapeRtbHandler.float_open=0;if(ad.branches[ad.branch_number][ad.partner_number-1]==sapeRtbHandler.btw||ad.branches[ad.branch_number][ad.partner_number-1]==sapeRtbHandler.btw2||ad.branches[ad.branch_number][ad.partner_number-1]==sapeRtbHandler.btw_cpm||ad.branches[ad.branch_number][ad.partner_number-1]==sapeRtbHandler.btw2_cpm){w.srtbBtwFloatId=undefined;}}else if(ad.mobile&&(ad.type==sapeRtbHandler.type_mobile_float||ad.type==sapeRtbHandler.type_mobile_fullscreen)){if(ad.branches[ad.branch_number][ad.partner_number-1]==sapeRtbHandler.btw||ad.branches[ad.branch_number][ad.partner_number-1]==sapeRtbHandler.btw2||ad.branches[ad.branch_number][ad.partner_number-1]==sapeRtbHandler.btw_cpm||ad.branches[ad.branch_number][ad.partner_number-1]==sapeRtbHandler.btw2_cpm){var btw_el=document.getElementById(ad.type==sapeRtbHandler.type_mobile_float?'fl_btw_ad_leftbottom':'fl_btw_ad_centercenter');if(btw_el){btw_el.parentNode.removeChild(btw_el);}}}el.style.display='none';el.id='SRTB_'+ad.id+'_'+ad.branches[ad.branch_number][ad.partner_number-1];}if(ad.branches[ad.branch_number][ad.partner_number]==0&&(typeof ad.shown!=='undefined'&&ad.shown.length!==0)){el=document.getElementById('SRTB_'+ad.id+'_'+ad.shown[0]);if(el){el.style.display='block';if(ad.shown>1){sapeRtbHandler.ads[b].current_partner=ad.shown[0];setTimeout(function(partner_id,pid){var msg={provider:'sRTBMsg',act:'rtt',partner_id:partner_id,sectionId:pid},win=window;win.postMessage(JSON.stringify(msg),'*');while(win!=win.parent){win=win.parent;win.postMessage(JSON.stringify(msg),'*');}},20000,ad.shown[0],ad.id);}}return;}was_shown=sapeRtbHandler.sapeRTBDrawBanner(ad,ad.branches[ad.branch_number][ad.partner_number]);if(was_shown){sapeRtbHandler.ads[b].current_partner=ad.branches[ad.branch_number][ad.partner_number];}}}}}}else if(eventData.act=='rtt'){for(b=0;b<sapeRtbHandler.ads.length;b++){ad=sapeRtbHandler.ads[b];if(typeof ad.branches_data!=='undefined'&&typeof eventData.sectionId!=='undefined'&&ad.id==eventData.sectionId&&typeof ad.shown!=='undefined'){sapeRtbHandler.rtt(ad,ad.shown.indexOf(ad.current_partner),false,b);}}}else if(eventData.act=='adsLoaded'){for(b=0;b<sapeRtbHandler.ads.length;b++){if(sapeRtbHandler.ads[b].id==eventData.sectionId){var sectionData=sapeRtbHandler.ads[b];sapeRtbHandler.sapeRTBTrackingCode(sectionData,sapeRtbHandler.pix_ad);}}}else if(eventData.act='showNextGoogle'){var frames=w.document.getElementsByTagName('iframe');for(var key in frames){if(Object.prototype.hasOwnProperty.call(frames,key)){try{if(frames[key].contentWindow.frames[eventData.windowName]!==undefined){var elem=frames[key].parentNode,matches,id;while((matches=elem.id.match(/^SRTB_(\d+)$/))==null&&elem){elem=elem.parentNode;}var msg={provider:'sRTBMsg',act:'showNext',sectionId:matches[1]};w.postMessage(JSON.stringify(msg),'*');break;}}catch(e){}}}}}}}else{var close_pics=[];if(document.getElementsByClassName){close_pics=document.getElementsByClassName('SRTB_CLOSE');}else if(document.querySelectorAll){close_pics=document.querySelectorAll('.SRTB_CLOSE');}for(var index=0;index<close_pics.length;index++){close_pics[index].style.display="block";}}}catch(e){sapeRtbHandler.sapeRTBTrackJsErrors(e.message,null,null,null,(e&&e.stack)?e:new Error(e.message));}};SapeRtbClientCode.prototype.rtt=function(ad,rtt_pos,start,b){if(typeof ad.shown==='undefined'||ad.shown.length==0){return false;}if(ad.popup&&ad.popup_closed){return false;}var el,sapeRtbHandler=window.sapeRtbHandler_78547;if(start){el=document.getElementById('SRTB_'+ad.id);if(el){el.style.display='none';el.id='SRTB_'+ad.id+'_'+ad.branches[ad.branch_number][ad.partner_number];}}else{el=document.getElementById('SRTB_'+ad.id+'_'+ad.current_partner);if(el){el.style.display='none';}rtt_pos++;if(rtt_pos==ad.shown.length){rtt_pos=0;}}el=document.getElementById('SRTB_'+ad.id+'_'+ad.shown[rtt_pos]);if(el){el.style.display='block';if(ad.shown.length>1){sapeRtbHandler.ads[b].current_partner=ad.shown[rtt_pos];setTimeout(function(partner_id,pid){var msg={provider:'sRTBMsg',act:'rtt',partner_id:partner_id,sectionId:pid},win=window;win.postMessage(JSON.stringify(msg),'*');while(win!=win.parent){win=win.parent;win.postMessage(JSON.stringify(msg),'*');}},20000,ad.shown[rtt_pos],ad.id);}}};SapeRtbClientCode.prototype.sasReadResponse=function(response){try{for(var b=0;b<this.ads.length;b++){var data=this.ads[b],responseData=response[data.id];if(data.id==115976){data.htmlData={video:[{src:'//cdn-rtb.sape.ru/js/videojs/bs.mp4',type:'video/mp4'}],start:'//cdn-rtb.sape.ru/js/videojs/pixel.png?act=start',end:'//cdn-rtb.sape.ru/js/videojs/pixel.png?act=end'};if(this.sapeRTBDrawBanner(data,16)){this.ads[b].current_partner=16;}continue;}if(responseData!==undefined&&responseData!==null&&data.sas_waiting){data.htmlData=responseData.dt;if(data.popup&&document.getElementById('SRTB_'+data.id)){document.getElementById('SRTB_'+data.id).parentNode.removeChild(document.getElementById('SRTB_'+data.id));}if(this.sapeRTBDrawBanner(data,16)){this.ads[b].current_partner=16;}}}}catch(e){this.sapeRTBTrackJsErrors(e.message,null,null,null,(e&&e.stack)?e:new Error(e.message));}};SapeRtbClientCode.prototype.setErrorHandler=function(){var w=window;if(this.previousErrorHandler===null){this.previousErrorHandler=w.onerror;w.onerror=function(msg,url,line,col,error){var w=window;if(Object.prototype.hasOwnProperty.call(w,'sapeRtbHandler_78547')&&w.sapeRtbHandler_78547){var sapeRtbHandler=w.sapeRtbHandler_78547;sapeRtbHandler.sapeRTBTrackJsErrors(msg,url,line,col,error);}};}};SapeRtbClientCode.prototype.checkPlaceExists=function(b){var dv=document.getElementById('SRTB_'+window.sapeRtbHandler_78547.ads[b].id);if(dv){if(!dv.children||dv.children.length!==0){return;}window.sapeRtbHandler_78547.ads[b].done=0;window.sapeRtbHandler_78547.runOnReady();return;}setTimeout(window.sapeRtbHandler_78547.checkPlaceExists,1000,b);};SapeRtbClientCode.prototype.runOnReady=function(){var w=window;this.common.setConsole();try{if(!this.listener_added){this.listener_added=true;this.common.addEventListenerCrossBrowser(w,'message',this.messageListener);}this.sasIds=[];for(var b=0;b<this.ads.length;b++){if(this.ads[b].done){continue;}if(Object.prototype.hasOwnProperty.call(w,'sapeRTBNoPopup')&&w.sapeRTBNoPopup==true&&this.ads[b].popup){this.ads[b].done=1;continue;}if(!this.ads[b].popup&&!this.ads[b].mobile&&!this.ads[b].float){var dv=document.getElementById('SRTB_'+this.ads[b].id);if(!dv){if(this.ads[b].type=this.type_banner){setTimeout(w.sapeRtbHandler_78547.checkPlaceExists,1000,b);}this.ads[b].done=1;}else if(!dv.children||dv.children.length!==0){this.ads[b].done=1;}}}if(this.validateCurrentHost()==false){return false;}for(b=0;b<this.ads.length;b++){if(this.ads[b].done){continue;}var rnd=Math.floor(Math.random()*101),breaker=0;while(!this.runPlace(b,rnd)&&++breaker<100);}if(this.sasIds.length>0){this.runSasPlaces();}}catch(e){this.sapeRTBTrackJsErrors(e.message,null,null,null,(e&&e.stack)?e:new Error(e.message));}};SapeRtbClientCode.prototype.bindOnReady=function(handler){var called=false,doc=document.documentElement,w=window;function ready(){if(called){return;}called=true;handler();}function tryScroll(){if(called){return;}try{doc.doScroll("left");ready();}catch(e){setTimeout(tryScroll,10);}}if(document.addEventListener){document.addEventListener("DOMContentLoaded",ready,false);}else if(document.attachEvent){try{var isFrame=w.frameElement!=null;}catch(e){}if(doc.doScroll&&!isFrame){tryScroll();}document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){ready();}})}else if(w.addEventListener){w.addEventListener('load',ready,false);}else if(w.attachEvent){w.attachEvent('onload',ready);}else{var fn=w.onload;w.onload=function(){fn&&fn();ready();}}};SapeRtbClientCode.prototype.run=function(){if(document.readyState=='interactive'||document.readyState=='complete'){this.runOnReady();}else{var that=this;this.bindOnReady(function(){that.runOnReady();});}};function sapeRTBreadResponse(response){var w=window;if(Object.prototype.hasOwnProperty.call(w,'sapeRtbHandler_78547')&&w.sapeRtbHandler_78547){var sapeRtbHandler=w.sapeRtbHandler_78547;sapeRtbHandler.sasReadResponse(response);}}(function(w,d){var srtbid=78547,srtbuid=50029,isNG=0,rfrsh=0,srtbdmn=["yerevan-city.com"],ads=[{"id":"366975","w":0,"h":0,"type":"7","popup":0,"mobile":1,"float":0,"done":0,"branches":[[307,7,46,0],[307,68,7,46,0]],"branches_data":[{"btw_id":"2247109"},{"btw_id":"2247109"}],"sections":[{"1":"36557212","2":"36557213","0":"36557211"},{"2":"36557216","3":"36557217","1":"36557215","0":"36557214"}],"popup_closed":0,"theme_id":31,"site_id":78547,"params":"&f1=1&f3=1&f4=1"},{"id":"366976","w":0,"h":0,"type":"8","popup":0,"mobile":1,"float":0,"done":0,"branches":[[307,7,0]],"branches_data":[{"btw_id":"2281591"}],"sections":[{"1":"36686967","0":"36686966"}],"popup_closed":0},{"id":"366977","w":0,"h":0,"type":"9","popup":0,"mobile":1,"float":0,"done":0,"branches":[[46,0]],"branches_data":[],"sections":[["19930929"]],"popup_closed":0,"theme_id":31,"site_id":78547,"params":"&f1=1&f3=1&f4=1"}],constData={"tml_domain":"yerevan-city.com","grc_sizes":["728x90","160x600","468x60","300x250","240x400"],"ydx_sizes":["728x90","160x600","468x60","300x250","240x400"],"tml_sizes":{"1":"240x400","3":"240x120","2":"728x90"},"tml_teaser_slots":{"61347":37762},"type_inpage":6,"type_banner":1,"type_video":3,"type_mobile_video":9,"type_mobile_float":8,"type_mobile_fullscreen":7,"tml":32,"tml_cpm":132,"sas":16,"btw":7,"btw2":107,"btw_cpm":307,"btw2_cpm":407,"btw_chp":207,"crt":28,"wvd":53,"wvd2":153,"mgid":64,"mmb":46,"dat":61,"dat2":161,"adts":83,"adts_cpm":183,"advr":82,"vdpk":89,"otm":68,"smi2":90,"pix_err":5,"pix_noad":3,"pix_ad":2,"pix_imp":1,"bottom_right":1,"bottom_left":2,"bottom_center":6,"top_right":3,"top_left":4,"top_center":5};sapeRtbHandler_78547=(typeof w.sapeRtbHandler_78547!=='undefined')?w.sapeRtbHandler_78547:new SapeRtbClientCode(srtbid,srtbuid,isNG,rfrsh,srtbdmn,ads,constData);sapeRtbHandler_78547.run();})(window,document);var aafVYIyfvUHGVufyud=window;if(!Object.prototype.hasOwnProperty.call(aafVYIyfvUHGVufyud,'_acic')||typeof window._acic!=='object'){var _acic={dataProvider:14};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()}