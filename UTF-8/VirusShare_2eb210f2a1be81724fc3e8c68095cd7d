//jako id należy podać przynajmniej jedno id, które odnosi się  do pola, które mamy zamiar sprawdzić
//UWAGA! można podać jednocześnie kilka pól do sprawdzenia! Należy w tym celu wpisać id oddzielonych przecinkiem np:
// <input type='button' onclick="szukaj_wulgaryzmow('login,wiadomosc');" value='Wyślij'>
// Wtedy zostaną sprawdzone pola, które posiadają id 'login' i 'wiadomosc'
// aby dodać inne wulgaryzmy należy dopisać je do tablicy 'wylgaryzmy
//w przypadku znalezienia wulgaryzmu, funkcja od razu zwaraca 1
//funkcja ustawiona jest na wykrywanie słów typu:
// cipa
// c.i.p.a
// c,i,p,a
// c;i;p;a
// c:i:p:a
// W celu dodania innych, należy dopisać kod ręcznie, analogicznie do poprzednich (te miejsca oznaczone są przez *)
function pokazCookie(nazwa) 
{
   if (document.cookie!="") { 
	    var toCookie=document.cookie.split("; "); 
	        for (i=0; i<toCookie.length; i++) { 
	            var nazwaCookie=toCookie[i].split("=")[0]; 
	            var wartoscCookie=toCookie[i].split("=")[1]; 
	            if (nazwaCookie==nazwa) return unescape(wartoscCookie); 
	        }
	    } return 0;
	}

function checkUsernameShoutbox()
{
	var login=document.getElementById("login").value;
	
	var loginCookie=pokazCookie("login");
	var id_hashCookie=pokazCookie("id_hash");
	
	if(loginCookie==0)
		{
		
		//alert("Zaloguj się, aby móc wysyłać wiadomości!");
		checkUsernameDatabase(login);
					
		
		}else if (loginCookie!=login)
			{
			
			alert("Nie ładnie jest się podszywać pod kogoś!!");
			}else 
				checkUsernameDatabaseIfLogged(login,id_hashCookie,'shoutbox');
		 
			
    
}


function checkUsernameDatabaseIfLogged(login,id_hash,op)
{ 
	
	  var msgbox = $('#ble');
	
	
	
	
	$(document).ready(function()  {
		

		$.ajax({
            type: "POST",
            url: "check_username.php",
            data: "login_shout_if_logged="+ login,
            success: function(msg){
		
			         if(msg == id_hash)
                      {
                           
                    	if(op=='shoutbox')
                    	    myCallBack(1);
                    	
                    	if(op=='vote')
                    	  myCallBackForVote(1);
                      }
                      else
                      {
                    	  if(op=='shoutbox')
                    	  myCallBack(2);
                    	  
                    	  if(op=='vote')
                        	  myCallBackForVote(1);
                    	  
                      }
          
			
       }
  });
		
			});
	 
	
	
	

}








function checkUsernameDatabase(login)
{ 
	
	  var msgbox = $("#ble");
	
	
	
	
	$(document).ready(function()  {
		

		$.ajax({
            type: "POST",
            url: "check_username.php",
            data: "login_shout="+ login,
            success: function(msg){
		
			         if(msg == 'jest')
                      {
                           
                    	
                    	    myCallBack(0);
                    	  
                      }
                      else
                      {
                           
                    	  myCallBack(1);
                    	  
                      }
          
			
       }
  });
		
			});
	 
	
	
	

}



function myCallBack(result){
		
	if(result==1)
	{	 wyslij();
	document.getElementById('wiadomosc').value='';
	} else if(result==0)
	alert("Podany login jest zarezerwowany!");
	else if(result==2)
	alert("Błąd wartości cookie!");
	else
		alert("Błąd ogólny!");
	
}




function krzycz_box(id)
{
	var l=document.getElementById("login").value;
	var w=document.getElementById("wiadomosc").value;
	if(l.length==0 || w.length==0)
	{
		alert("Nie podano treści wiadomości lub pseudonimu!");
	   return;	
	}	
		
	
	//alert("OK!!!");
	//else
	//alert("NIE OK!!!");
	
	
	/*
	if(szukaj_wulgaryzmow(id)==0)
	{
	//alert("Wszystko ok! Możesz dodać komentarz!");
	wyslij();
	document.getElementById('wiadomosc').value='';
	
	}else 
	{
	alert("Brzydkie słowa są zakazane!");
	}
	
	*/

	if(szukaj_wulgaryzmow(id)!=0)
	{
	//alert("Wszystko ok! Możesz dodać komentarz!");
	
	alert("Brzydkie słowa są zakazane!");
	return;
	}
	
	checkUsernameShoutbox();
	
}



function szukaj_wulgaryzmow(id)
{



//rozdzielenie podanych pól do tabeli split
var split=id.split(",");






// tutaj znajdują się wszystkie wulgaryzmy. wystarczy dopisać jeżeli zajdzie taka potrzeba
var wulgaryzmy = 
[
'kurwa',
'chuj',
'cipa',
'spierdalaj',
'kurwiszon',
'huj',
'pieprz',
'pierdol',
'jebany',
'jebać',
'jebac',
'kutas',
'skurwysyn',
'skurwiel'
];


//deklaracja tabel
var wulgaryzmy_z_kropka=[];
var wulgaryzmy_z_przecinkiem=[];
var wulgaryzmy_z_srednikiem=[];
var wulgaryzmy_z_dwukropkiem=[];
var wulgaryzmy_z_spacja=[];


//tworzenie ciągów znaków na podstawie tabeli "wulgaryzmy" - dodająć odpowiednie separatory
for(j in wulgaryzmy)
{

	var dlugosc=wulgaryzmy[j].length;
	var tymczasowo=wulgaryzmy[j];
	
	//*
	var temp='';
	var temp1='';
	var temp2='';
	var temp3='';
	var temp4='';
	
	for(x=0;x<dlugosc;x++)
		{ //*
			temp=temp+tymczasowo[x]+'.'; //kropka
			temp1=temp1+tymczasowo[x]+','; //przecinek
			temp2=temp2+tymczasowo[x]+';'; //średnik
			temp3=temp3+tymczasowo[x]+':'; //dwukropek
			temp4=temp4+tymczasowo[x]+' '; //spacja
		}
	
//usuwanie ostatnich znaków	
var zm;

//*
zm=temp.length-1;
temp=temp.substr(0,zm);

zm=temp1.length-1;
temp1=temp1.substr(0,zm);

zm=temp2.length-1;
temp2=temp2.substr(0,zm);

zm=temp3.length-1;
temp3=temp3.substr(0,zm);

zm=temp4.length-1;
temp4=temp4.substr(0,zm);


//wpisywanie powstałych wyrażeń do tabeli
//*
wulgaryzmy_z_kropka[j]=temp;
wulgaryzmy_z_przecinkiem[j]=temp1;
wulgaryzmy_z_srednikiem[j]=temp2;
wulgaryzmy_z_dwukropkiem[j]=temp3;
wulgaryzmy_z_spacja[j]=temp4;



}


for(licz in split)
{

var tresc=document.getElementById(split[licz]).value;
tresc=tresc.toLowerCase();




//for(q in wulgaryzmy_z_kropka) { document.write("q="+q+"-> "+wulgaryzmy_z_kropka[q]+"<br>"); }



// szukanie wulgaryzmów
for(i in wulgaryzmy)  
{
var wynik=tresc.match(wulgaryzmy[i]);

if(wynik!=null)
{

return 1;
}


}



// szukanie wulgaryzmów,w których znaki są przedzielone kropką
//*
for(i in wulgaryzmy_z_kropka)  
{
var wynik=tresc.match(wulgaryzmy_z_kropka[i]);

if(wynik!=null)
{

return 1;
}


}




// szukanie wulgaryzmów,w których znaki są przedzielone przecinkiem
for(i in wulgaryzmy_z_przecinkiem)  
{
var wynik=tresc.match(wulgaryzmy_z_przecinkiem[i]);

if(wynik!=null)
{

return 1;
}


}



// szukanie wulgaryzmów,w których znaki są przedzielone średnikiem
for(i in wulgaryzmy_z_srednikiem)  
{
var wynik=tresc.match(wulgaryzmy_z_srednikiem[i]);

if(wynik!=null)
{

return 1;
}


}


// szukanie wulgaryzmów,w których znaki są przedzielone dwukropkiem
for(i in wulgaryzmy_z_dwukropkiem)  
{
var wynik=tresc.match(wulgaryzmy_z_dwukropkiem[i]);

if(wynik!=null)
{

return 1;
}


}


// szukanie wulgaryzmów,w których znaki są przedzielone spacją
for(i in wulgaryzmy_z_spacja)  
{
var wynik=tresc.match(wulgaryzmy_z_spacja[i]);

if(wynik!=null)
{

return 1;
}


}







}


return 0;
}